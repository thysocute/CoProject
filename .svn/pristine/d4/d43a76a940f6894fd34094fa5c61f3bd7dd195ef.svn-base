require.define({
  "ep_etherpad-lite/static/js/ace2_inner.js": function (require, exports, module) {
function Ace2Inner(){function e(){return Math.round(4*An/3)}function t(){Nn=Nt("dynamicsyntax"),Tn=Nt("dynamicsyntax","outer"),_n=Nt("dynamicsyntax","parent")}function n(){return On}function r(e,t){if(Nn){var n=l(i(e)),r=hooks.callAll("aceSetAuthorStyle",{dynamicCSS:Nn,parentDynamicCSS:_n,outerDynamicCSS:Tn,info:t,author:e,authorSelector:n});if(!_.any(r,function(e){return e}))if(t){if(t.bgcolor){var o=t.bgcolor;"number"==typeof t.fade&&(o=c(o,t.fade));var a=Nn.selectorStyle(n),s=_n.selectorStyle(n),u=Nn.selectorStyle(n+" > a");a.backgroundColor=o,s.backgroundColor=o,It.luminosity(It.css2triple(o))<.5?(a.color="#ffffff",s.color="#ffffff"):(a.color=null,s.color=null),It.luminosity(It.css2triple(o))<.55?u.color=It.triple2css(It.complementary(It.css2triple(o))):u.color=null}}else Nn.removeSelectorStyle(n),_n.removeSelectorStyle(n)}}function o(e,t){if("string"!=typeof e)throw new Error("setAuthorInfo: author ("+e+") is not a string");t?On[e]=t:delete On[e],r(e,t)}function i(e){return"author-"+e.replace(/[^a-y0-9]/g,function(e){return"."==e?"-":"z"+e.charCodeAt(0)+"z"})}function a(e){return"author-"==e.substring(0,7)?e.substring(7).replace(/[a-y0-9]+|-|z.+?z/g,function(e){return"-"==e?".":"z"==e.charAt(0)?String.fromCharCode(Number(e.slice(1,-1))):e}):null}function l(e){return".authorColors ."+e}function s(){if(Nn){var t=nn.offsetHeight,n=e(),r=0,o=0;n>t&&(r=Math.ceil((n-t)/2),o=n-t-r);var i=Nn.selectorStyle("#innerdocbody span");i.paddingTop=o+"px",i.paddingBottom=r+"px"}}function c(e,t){var n=It.css2triple(e);return n=It.blend(n,[1,1,1],t),It.triple2css(n)}function u(e){return!Kn[e]}function d(e,t){function n(){a=!0,yn.profile()}function r(e){return{eventType:e,backset:null}}function o(e){if(sn.selStart&&sn.selEnd){var t=sn.lines.offsetOfIndex(sn.selStart[0])+sn.selStart[1],n=sn.lines.offsetOfIndex(sn.selEnd[0])+sn.selEnd[1];e.selStart=t,e.selEnd=n,e.selFocusAtStart=sn.selFocusAtStart}if(Ft.enabled){var r=!1;try{Ie(e.eventType)?Ft.clearHistory():"nonundoable"==e.eventType?e.changeset&&Ft.reportExternalChange(e.changeset):Ft.reportEvent(e),r=!0}finally{r||(Ft.enabled=!1)}}}function i(e,t){var n=Dn.editEvent;return t||o(n),Dn.editEvent=r(e),n}if(!Gt){Dn&&yn.error("Can't enter callstack "+e+", already in "+Dn.type);var a=!1;Dn={type:e,docTextChanged:!1,selectionAffected:!1,userChangedSelection:!1,domClean:!1,profileRest:n,isUserChange:!1,repChanged:!1,editEvent:r(e),startNewEvent:i};var l,s=!1;try{l=t(),hooks.callAll("aceEditEvent",{callstack:Dn,editorInfo:Jt,rep:sn,documentAttributeManager:dn}),s=!0}catch(c){throw Qt.push({error:c,time:+new Date}),En(c.toString()),c}finally{var d=Dn;s?(o(d.editEvent),d.domClean&&"setup"!=d.type&&(d.selectionAffected&&Qe(),(d.docTextChanged||d.userChangedSelection)&&u(d.type)&&vt(),d.docTextChanged&&d.type.indexOf("importText")<0&&ln())):"idleWorkTimer"==Dn.type&&Pn.atLeast(1e3),Dn=null,a&&yn.profileEnd()}return l}}function f(e,t){Dn?t():d(e,t)}function p(){Gt=!0,Pn&&Pn.never(),nt()}function h(){return}function g(e){pn=e;ct(cn,"doesWrap",pn),kn.setTimeout(function(){f("setWraps",function(){B(7),b(),tt()})},0),browser.chrome&&$("#innerdocbody").addClass("noprewrap")}function v(e){var t=gn;gn=!!e,e!=t&&(e||f("setStyled",function(){B(12);var e=[];for(var t in $n)e.push([t,""]);he(0,sn.alltext.length,e)}))}function m(e){In=e,cn.style.fontFamily=In,nn.style.fontFamily=In,kn.setTimeout(function(){s()},0)}function x(t){An=t,cn.style.fontSize=An+"px",cn.style.lineHeight=e()+"px",tn.style.lineHeight=e()+"px",nn.style.fontSize=An+"px",kn.setTimeout(function(){s()},0)}function b(){V(0,sn.alltext.length)}function y(e){fn=e,rt(fn?!0:!1),ct(cn,"static",!fn)}function S(){y(fn)}function w(e,t,n){var r;if(n){if("\n"!=e.charAt(e.length-1))throw new Error("new raw text must end with newline");if(/[\r\t\xa0]/.exec(e))throw new Error("new raw text must not contain CR, tab, or nbsp");r=e.substring(0,e.length-1).split("\n")}else r=_.map(e.split("\n"),Le);var o="\n";if(r.length>0&&(o=r.join("\n")+"\n"),f("importText"+(t?"Undoable":""),function(){k(o)}),n&&sn.alltext!=e)throw new Error("mismatch error setting raw text in importText")}function C(e,t,n){if(e=Lt.cloneAText(e),t){var r=(new _t).fromJsonable(t);e.attribs=Lt.moveOpsToNewPool(e.attribs,r,sn.apool)}f("importText"+(n?"Undoable":""),function(){E(e)})}function E(e){B(8);var t=sn.lines.totalWidth(),n=sn.lines.length(),r=sn.lines.offsetOfIndex(n-1),o=sn.lines.atIndex(n-1).text.length,i=Lt.smartOpAssembler(),a=Lt.newOp("-");a.chars=r,a.lines=n-1,i.append(a),a.chars=o,a.lines=0,i.append(a),Lt.appendATextToAssembler(e,i);var l=t+i.getLengthChange(),s=Lt.checkRep(Lt.pack(t,l,i.toString(),e.text.slice(0,-1)));if(se(s),Ee([0,sn.lines.atIndex(0).lineMarker],[0,sn.lines.atIndex(0).lineMarker]),Pn.atMost(100),sn.alltext!=e.text)throw En(htmlPrettyEscape(sn.alltext)),En(htmlPrettyEscape(e.text)),new Error("mismatch error setting raw text in setDocAText")}function k(e){E(Lt.makeAText(e))}function I(){var e=sn.alltext,t=e.length;return t>0&&t--,e.substring(0,t)}function A(){return Dn&&!Dn.domClean&&f("exportText",function(){B(2)}),I()}function N(){tt()}function T(e){an=e}function L(e){on=e}function O(e){ln=e}function K(){Dn&&!Dn.domClean&&f("getFormattedCode",Q);var e=[];if(sn.lines.length()>0)for(var t=sn.lines.atIndex(0);t;){var n=t.domInfo;e.push(n&&n.getInnerHTML()||Tt.processSpaces(Tt.escapeHTML(t.text),pn)||"&nbsp;"),t=sn.lines.next(t)}return'<div class="syntax"><div>'+e.join("</div>\n<div>")+"</div></div>"}function D(e){e=e.toLowerCase();var t=Array.prototype.slice.call(arguments,1);Fn[e]&&f(e,function(){B(9),Fn[e].apply(Fn,t)})}function F(e,t,n){f("replaceRange",function(){B(9),pe(e,t,n)})}function M(){return Date.now()}function P(e){var t=M(),n=0,r=!1,o=!1,i=function(){if(r)return o||(o=!0),!0;var i=M()-t;return i>e?(r=!0,!0):(n=i,!1)};return i.elapsed=function(){return M()-t},i}function R(e){function t(){o&&(kn.clearTimeout(o),o=null)}function n(e){t(),i=e;var n=e-M();0>n&&(n=0),o=kn.setTimeout(r,n)}function r(){o=null,e()}var o=null,i=0;return{atMost:function(e){var t=M()+e;(!o||i>t)&&n(t)},atLeast:function(e){var t=M()+e;(!o||t>i)&&n(t)},never:function(){t()}}}function B(e){Q(P(0))}function H(e){var t=e.id;return t?t:e.id="magicdomid"+Rn++}function V(e,t,n,r){if(!(e>=t||0>e||e>=sn.lines.totalWidth())){var o=sn.lines.atOffset(e),i=sn.lines.offsetOfEntry(o),a=sn.lines.indexOfEntry(o),l=!1,s=null,c=null;n=n||noop;var u,d=function(e,t){o.domInfo.appendSpan(e,t)};if(r){var f=d;d=function(e,t){r(e,t,f,u),u+=e.length}}for(;o&&t>i&&!n();){var p=i+o.width;u=i,o.domInfo.clearSpans(),U(o,d,i),o.domInfo.finishUpdate(),De(o.lineNode),(sn.selStart&&sn.selStart[0]==a||sn.selEnd&&sn.selEnd[0]==a)&&(l=!0),null===s&&(s=a),c=a,i=p,o=sn.lines.next(o),a++}l&&(Dn.selectionAffected=!0)}}function U(e,t,n){var r=n;"number"!=typeof r&&(r=sn.lines.offsetOfEntry(e));var o=e.text;e.width;if(0===o.length){var i=Kt.getLineStyleFilter(0,"",t,sn.apool);i("","")}else{var a=Kt.getFilterStack(o,t,browser),l=sn.lines.indexOfEntry(e),s=sn.alines[l];a=Kt.getLineStyleFilter(o.length,s,a,sn.apool),a(o,"")}}function W(){Mn={cleanNodesNearChanges:{}}}function q(e){var t=Cn("getCleanNodeByKey",!1);t.extra=0;for(var n=un.getElementById(e);n&&Fe(n);)t.extra++,n.id="",n=un.getElementById(e);return t.literal(t.extra,"extra"),t.end(),n}function z(e){var t,n;if(Fe(e)){for(var r=e.previousSibling;r&&Fe(r);)r=r.previousSibling;if(r)t=r;else{for(var o=e.nextSibling;o&&Fe(o);)o=o.nextSibling;o&&(t=o)}if(!t)return;n=!0}else{t=e;var i=t.previousSibling,a=t.nextSibling;n=i&&Fe(i)||a&&Fe(a)}if(n)Mn.cleanNodesNearChanges["$"+H(t)]=!0;else{var l=H(t),i=t.previousSibling,a=t.nextSibling,s=i&&H(i)||null,c=a&&H(a)||null,u=sn.lines.prev(sn.lines.atKey(l)),d=sn.lines.next(sn.lines.atKey(l)),f=u&&u.key||null,p=d&&d.key||null;s==f&&c==p||(Mn.cleanNodesNearChanges["$"+H(t)]=!0)}}function j(){if(!Dn.observedSelection){Dn.observedSelection=!0;var e=Cn("getSelection",!1),t=Je();if(e.end(),t){var n=lt(t.startPoint.node),r=lt(t.endPoint.node);n&&z(n),r&&n!=r&&z(r)}}}function Y(){if(cn.getElementsByTagName)for(var e=cn.getElementsByTagName("style"),t=0;t<e.length;t++){var n=lt(e[t]);n&&n.parentNode==cn&&z(n)}}function Q(e){if(Dn.domClean)return!1;if(Dn.isUserChange=!0,e=e||function(){return!1},Rt&&window.DONT_INCORP||window.DEBUG_DONT_INCORP)return!1;var t=Cn("incorp",!1);cn.firstChild||(cn.innerHTML="<div><!-- --></div>"),t.mark("obs"),j(),Y(),t.mark("dirty");for(var n,r,o=Ke(),i=!0,l=0;l<o.length;){if(n=o[l][0],r=o[l][1],0!==n&&!q(sn.lines.atIndex(n-1).key)||r!=sn.lines.length()&&!q(sn.lines.atIndex(r).key)){i=!1;break}l++}if(!i){for(var s=cn.childNodes.length,c=0;s>c;c++){var u=cn.childNodes.item(c);!u.tagName||u.id&&sn.lines.containsKey(u.id)||z(u)}o=Ke()}W(),t.mark("getsel");var d,f,p=Je(),h=0,g=[],v=0,m=[];t.mark("ranges"),t.literal(o.length,"numdirt");for(var x=[];h<o.length;){var b=o[h];n=b[0],r=b[1];var y=0===n&&cn.firstChild||q(sn.lines.atIndex(n-1).key).nextSibling;y=y&&Fe(y)&&y;var S=r==sn.lines.length()&&cn.lastChild||q(sn.lines.atIndex(r).key).previousSibling;if(S=S&&Fe(S)&&S,y&&S){var w=At(gn,browser,sn.apool,null,a);w.notifySelection(p);for(var C=[],E=y;E&&(!E.previousSibling||E.previousSibling!=S);E=E.nextSibling){if(browser.msie)try{E.createTextRange().execCommand("unlink",!1,null)}catch(k){}w.collectContent(E),C.push(E)}w.notifyNextNode(S.nextSibling);var I=w.getLines();if((I.length<=1||""!==I[I.length-1])&&S.nextSibling){r++;var A=S.nextSibling;w.collectContent(A),m.push(A),w.notifyNextNode(A.nextSibling)}var N=w.finish(),T=N.selStart,L=N.selEnd;I=N.lines;var O=N.lineAttribs,K=N.linesWrapped,D=!1;if(K>0&&!browser.msie)var D=!0;T[0]>=0&&(d=[T[0]+n+v,T[1]]),L[0]>=0&&(f=[L[0]+n+v,L[1]]);for(var F=[],M=S,P=new Array(I.length),c=0;c<I.length;c++){var R=I[c],B=le(R);F.push(B),P[c]=B.domInfo}x.push([M,P]),_.each(C,function(e){m.push(e)});var H={};d&&(H.selStart=d),f&&(H.selEnd=f),g.push([n+v,r-n,F,O,H]),v+=I.length-(r-n)}else r>n&&g.push([n+v,r-n,[],[]]);h++}var V=g.length>0;if(t.mark("splice"),_.each(g,function(e){ye(e[0],e[1],e[2],e[3],e[4])}),t.mark("insert"),_.each(x,function(t){J(t[0],t[1],e)}),t.mark("del"),_.each(m,function(e){e.parentNode&&e.parentNode.removeChild(e)}),D&&$("#innerdocbody").scrollLeft(0),t.mark("findsel"),p&&!d){var U=hooks.callAll("aceStartLineAndCharForPoint",{callstack:Dn,editorInfo:Jt,rep:sn,root:cn,point:p.startPoint,documentAttributeManager:dn});d=null==U||0==U.length?ae(p.startPoint):U}if(p&&!f){var Q=hooks.callAll("aceEndLineAndCharForPoint",{callstack:Dn,editorInfo:Jt,rep:sn,root:cn,point:p.endPoint,documentAttributeManager:dn});f=null==Q||0==Q.length?ae(p.endPoint):Q}var X=sn.lines.length();return d&&d[0]>=X&&(d[0]=X-1,d[1]=sn.lines.atIndex(d[0]).text.length),f&&f[0]>=X&&(f[0]=X-1,f[1]=sn.lines.atIndex(f[0]).text.length),t.mark("repsel"),p&&ke(d,f,p&&p.focusAtStart),t.mark("browsel"),p&&(V||Z())&&(Dn.selectionAffected=!0),Dn.domClean=!0,t.mark("fixview"),tt(),t.end("END"),V}function X(e){return!!$n[e]}function G(e){return-1!==Mt.DEFAULT_LINE_ATTRIBUTES.indexOf(e)}function J(e,t,n){n=n||function(){return!1};var r,o;if(!(t.length<1)){var i=sn.lines.atKey(H(t[0].node)),a=sn.lines.atKey(H(t[t.length-1].node));sn.lines.offsetOfEntry(i),sn.lines.offsetOfEntry(a)+a.width;_.each(t,function(t){var i,a=Cn("insertLine",!1),l=t.node,s=H(l);if(a.mark("findEntry"),r){var c=sn.lines.next(r);c&&c.key==s&&(i=c,o+=r.width)}i?a.literal(0,"nonopt"):(a.literal(1,"nonopt"),i=sn.lines.atKey(s),o=sn.lines.offsetOfKey(s)),r=i,a.mark("spans"),U(i,function(e,n){t.appendSpan(e,n)},o,n()),a.mark("addLine"),t.prepareForAdd(),i.lineMarker=t.lineMarker,e?cn.insertBefore(l,e.nextSibling):cn.insertBefore(l,cn.firstChild),e=l,t.notifyAdded(),a.mark("markClean"),De(l),a.end()})}}function Z(){return sn.selStart&&sn.selEnd&&sn.selStart[0]==sn.selEnd[0]&&sn.selStart[1]==sn.selEnd[1]}function ee(){return sn.selStart[0]}function te(){return sn.selStart[1]}function ne(){return sn.lines.offsetOfIndex(ee())+te()}function re(){if(Z()&&0===te()&&ee()>0){var e=ee(),t=sn.lines.atIndex(e),n=sn.lines.prev(t),r=n.text,o=/^ *(?:)/.exec(r)[0],i=parent.parent.clientVars.indentationOnNewLine;i&&/[\[\(\:\{]\s*$/.exec(r)&&(o+=Bt);var a=Lt.builder(sn.lines.totalWidth()).keep(sn.lines.offsetOfIndex(e),e).insert(o,[["author",Xt]],sn.apool).toString();se(a),Ee([e,o.length],[e,o.length])}}function oe(e){var t=e[0],n=e[1],r=sn.lines.atIndex(t);n-=r.lineMarker,0>n&&(n=0);var o=r.lineNode,i=o,a=!1;if(0===n){var l=0;return browser.msie&&parseInt(browser.version)>=11&&(browser.msie=!1),browser.msie&&t==sn.lines.length()-1&&0===o.childNodes.length&&(l=1),{node:o,index:l,maxIndex:1}}for(;i!=o||!a;)if(a)i.nextSibling?(i=i.nextSibling,a=!1):i=i.parentNode;else if(isNodeText(i)){var s=i.nodeValue.length;if(s>=n)return{node:i,index:n,maxIndex:s};n-=s,a=!0}else i.firstChild?i=i.firstChild:a=!0;return{node:o,index:1,maxIndex:1}}function ie(e){return browser.msie?e.innerText:e.textContent||e.nodeValue||""}function ae(e){if(e.node==cn){if(0===e.index)return[0,0];var t=sn.lines.length(),n=sn.lines.atIndex(t-1);return[t-1,n.text.length]}var r=e.node,o=0;isNodeText(r)?o=e.index:e.index>0&&(o=ie(r).length);for(var i,a;(i=r.parentNode)!=cn;)(a=r.previousSibling)?(r=a,o+=ie(r).length):r=i;""===r.id&&yn.debug("BAD"),r.firstChild&&Oe(r.firstChild)&&(o+=1);var l=sn.lines.atKey(r.id),s=sn.lines.indexOfEntry(l);return[s,o]}function le(e){var t=_e(e.length>0),n=t.node;return{key:H(n),text:e,lineNode:n,domInfo:t,lineMarker:0}}function se(e,t){function n(e,t,n,r){r=r||P(50);var o=[];if(t>0)for(var i=sn.lines.atIndex(e),a=0;t>a;a++)o.push(i.key),i=sn.lines.next(i);var l=_.map(n,le);be(e,t,l);var s;s=e>0?q(sn.lines.atIndex(e-1).key):null,J(s,_.map(l,function(e){return e.domInfo}),r),_.each(o,function(e){var t=un.getElementById(e);t.parentNode.removeChild(t)}),(sn.selStart&&sn.selStart[0]>=e&&sn.selStart[0]<=e+t||sn.selEnd&&sn.selEnd[0]>=e&&sn.selEnd[0]<=e+t)&&(Dn.selectionAffected=!0)}ue(e,t);var r=null;if(sn.selStart&&sn.selEnd){var o=sn.lines.offsetOfIndex(sn.selStart[0])+sn.selStart[1],i=sn.lines.offsetOfIndex(sn.selEnd[0])+sn.selEnd[1],a=Lt.characterRangeFollow(e,o,i,t);r=[a[0],a[1],sn.selFocusAtStart]}var l={splice:function(e,t,r){var o=Array.prototype.slice.call(arguments,2);n(e,t,_.map(o,function(e){return e.slice(0,-1)}),null)},get:function(e){return sn.lines.atIndex(e).text+"\n"},length:function(){return sn.lines.length()},slice_notused:function(e,t){return _.map(sn.lines.slice(e,t),function(e){return e.text+"\n"})}};Lt.mutateTextLines(e,l),h(),r&&Ee(de(r[0]),de(r[1]),r[2])}function ce(e){return!0}function ue(e,t){if(Lt.checkRep(e),Lt.oldLen(e)!=sn.alltext.length)throw new Error("doRepApplyChangeset length mismatch: "+Lt.oldLen(e)+"/"+sn.alltext.length);if(!ce(e))throw new Error("doRepApplyChangeset line break mismatch");!function(e){var t=Dn.editEvent;if("nonundoable"==t.eventType)t.changeset?t.changeset=Lt.compose(t.changeset,e,sn.apool):t.changeset=e;else{var n=Lt.inverse(e,{get:function(e){return sn.lines.atIndex(e).text+"\n"},length:function(){return sn.lines.length()}},sn.alines,sn.apool);t.backset?t.backset=Lt.compose(n,t.backset,sn.apool):t.backset=n}}(e),Lt.mutateAttributionLines(e,sn.alines,sn.apool),Ln.isTracking()&&Ln.composeUserChangeset(e)}function de(e){var t=sn.lines.atOffset(e),n=sn.lines.offsetOfEntry(t),r=sn.lines.indexOfEntry(t);return[r,e-n]}function fe(e,t,n){e==t&&0===n.length||(t==sn.alltext.length&&(e==t?(e--,t--,n="\n"+n.substring(0,n.length-1)):0===n.length?(e--,t--):(t--,n=n.substring(0,n.length-1))),pe(de(e),de(t),n))}function pe(e,t,n){void 0===e&&(e=sn.selStart),void 0===t&&(t=sn.selEnd);var r=Lt.builder(sn.lines.totalWidth());Ot.buildKeepToStartOfRange(sn,r,e),Ot.buildRemoveRange(sn,r,e,t),r.insert(n,[["author",Xt]],sn.apool);var o=r.toString();se(o)}function he(e,t,n){t=Math.min(t,sn.alltext.length-1),dn.setAttributesOnRange(de(e),de(t),n)}function ge(e,t){sn.selStart&&sn.selEnd&&dn.setAttributesOnRange(sn.selStart,sn.selEnd,[[e,t]])}function ve(e,t){function n(e){return a.test(e)}function r(e,t){if(e[1]==t[1]&&e[0]==t[0])return!1;if(e[0]!=t[0]){var o=!0;o=o&&r(e,[e[0],sn.lines.atIndex(e[0]).text.length]);for(var i=e[0]+1;i<t[0];i++)o=o&&r([i,0],[i,sn.lines.atIndex(i).text.length]);return o=o&&r([t[0],0],[t[0],t[1]])}for(var a=e[0],l=e[1],s=t[1],o=!0,c=Lt.opIterator(sn.alines[a]),u=0;c.hasNext();){var d=c.next(),f=u,p=f+d.chars;if(!n(d.attribs)&&!(l>=p||f>=s)){o=!1;break}u=p}return o}if(sn.selStart&&sn.selEnd){var o=sn.selStart[0]==sn.selEnd[0]&&sn.selEnd[1]===sn.selStart[1];o&&t&&0!==sn.selStart[1]&&sn.selStart[1]--;var i=Lt.makeAttribsString("+",[[e,"true"]],sn.apool),a=new RegExp(i.replace(/\*/g,"\\*")+"(\\*|$)");return r(sn.selStart,sn.selEnd)}}function me(e){function t(e){return o.test(e)}if(sn.selStart&&sn.selEnd){for(var n=!0,r=Lt.makeAttribsString("+",[[e,"true"]],sn.apool),o=new RegExp(r.replace(/\*/g,"\\*")+"(\\*|$)"),i=sn.selStart[0],a=sn.selEnd[0],l=i;a>=l;l++){var s=Lt.opIterator(sn.alines[l]),c=0,u=0;dn.lineHasMarker(l)&&(u=1);var d=sn.lines.atIndex(l).text.length;for(l==i&&(u=sn.selStart[1]),l==a&&(d=sn.selEnd[1]);s.hasNext();){var f=s.next(),p=c,h=p+f.chars;if(!t(f.attribs)&&!(u>=h||p>=d)){n=!1;break}c=h}if(!n)break}var g=n?"":"true";dn.setAttributesOnRange(sn.selStart,sn.selEnd,[[e,g]]),Ne(e)&&Ae(e,!n)}}function xe(e){sn.selStart&&sn.selEnd&&pe(sn.selStart,sn.selEnd,e)}function be(e,t,n){_.each(n,function(e){e.width=e.text.length+1});var r=sn.lines.offsetOfIndex(e),o=sn.lines.offsetOfIndex(e+t);sn.lines.offsetOfIndex(e),sn.lines.offsetOfIndex(e+t);sn.lines.splice(e,t,n),Dn.docTextChanged=!0,Dn.repChanged=!0;var i=(sn.lines.offsetOfIndex(e+n.length),_.map(n,function(e){return e.text+"\n"}).join(""));sn.alltext=sn.alltext.substring(0,r)+i+sn.alltext.substring(o,sn.alltext.length)}function ye(e,t,n,r,o){var i,a,l=sn.lines.offsetOfIndex(e),s=sn.lines.offsetOfIndex(e+t),c=sn.lines.offsetOfIndex(e);o&&o.selStart&&(i=sn.lines.offsetOfIndex(o.selStart[0])+o.selStart[1]-c),o&&o.selEnd&&(a=sn.lines.offsetOfIndex(o.selEnd[0])+o.selEnd[1]-c);var u=_.map(n,function(e){return e.text+"\n"}).join(""),d=sn.alltext.substring(l,s),f=sn.alines.slice(e,e+t).join(""),p=r.join("|1+1")+"|1+1",g=we(d,u,f,p,i,a),v=g[0],m=g[1],x=d.substring(v,d.length-m),b=u.substring(v,u.length-m),y=l+v,S=s-m,w=!1;if("\n"==x.charAt(x.length-1)&&"\n"==b.charAt(b.length-1)&&(x=x.slice(0,-1),b=b.slice(0,-1),S--,m++),0===x.length&&y==sn.alltext.length&&b.length>0&&(y--,S--,b="\n"+b.slice(0,-1),w=!0),S==sn.alltext.length&&x.length>0&&0===b.length&&"\n"==sn.alltext.charAt(y-1)&&(y--,S--),0!==x.length||0!==b.length){var C,E=sn.alltext,k=E.length,I=sn.lines.indexOfOffset(y),A=sn.lines.offsetOfIndex(I),N=function(){var e=Lt.builder(k);return e.keep(A,I),e.keep(y-A),e},T=function(e,t){for(var n=Lt.opIterator(e),r=0,o=v,i=u.length-m-(w?1:0);n.hasNext();){var a=n.next(),l=r+a.chars;o>=l||r>=i||t(Math.max(o,r),Math.min(i,l),a.attribs),r=l}},L=b==x;if(L){var O=Se(function(e){return Lt.mapAttribNumbers(e,function(e){var t=sn.apool.getAttribKey(e);return X(t)?sn.apool.putAttrib([t,""]):!1})}),K=N();w&&K.keep(1,1),T(f,function(e,t,n){K.keepText(u.substring(e,t),O(n))});var D=K.toString(),F=N();w&&F.keep(1,1),T(p,function(e,t,n){F.keepText(u.substring(e,t),n)});var M=F.toString();C=Lt.compose(D,M,sn.apool)}else{var P=N(),R=sn.lines.indexOfOffset(S),$=sn.lines.offsetOfIndex(R);$>y?(P.remove($-y,R-I),P.remove(S-$)):P.remove(S-y);var B=!1,H=Lt.makeAttribsString("+",Xt?[["author",Xt]]:[],sn.apool),V=Se(function(e){return B?Lt.composeAttributes(H,e,!0,sn.apool):Lt.composeAttributes(e,H,!0,sn.apool)}),U="";T(p,function(e,t,n){var r=Lt.attribsAttributeValue(n,"author",sn.apool);r&&r!=U&&(U?B=!0:U=r)}),w&&P.insert("\n",V("")),T(p,function(e,t,n){P.insert(u.substring(e,t),V(n))}),C=P.toString()}ue(C)}be(e,t,n),h()}function Se(e){var t={};return function(n){return t[n]||(t[n]=e(n)),t[n]}}function we(e,t,n,r,o,i){function a(e){return!G(sn.apool.getAttribKey(e))}function l(e){for(var t=[],n=[],r=Lt.opIterator(e);r.hasNext();){var o=r.next();t.push(o.chars),n.push(o.attribs)}return[t,n]}function s(e,t){var n=e[0],r=e[1],o=t?n.length-1:0,i=0;return function(){for(;i>=n[o];)t?o--:o++,i=0;var e=r[o];return i++,e}}for(var c=e.length,u=t.length,d=Math.min(c,u),f=l(Lt.filterAttribNumbers(n,a)),p=l(Lt.filterAttribNumbers(r,a)),h=0,g=s(f,!1),v=s(p,!1);d>h&&e.charAt(h)==t.charAt(h)&&g()==v();)h++;for(var m=0,x=s(f,!0),b=s(p,!0);d>m;)if(0===m)x(),b(),m++;else{if(e.charAt(c-1-m)!=t.charAt(u-1-m)||x()!=b())break;m++}var y=-1;if("number"==typeof i&&(y=u-i),h+m>c){var S=c-h,w=m;m=y>=S&&w>=y?y:S,h=c-m}if(h+m>u){var S=u-h,w=m;m=y>=S&&w>=y?y:S,h=u-m}return[h,m]}function Ce(e,t){return e?t?e[0]==t[0]&&e[1]==t[1]:!e:!t}function Ee(e,t,n){ke(e,t,n)&&(Dn.selectionAffected=!0)}function ke(e,t,n){n=!!n;var r=n&&(!e||!t||e[0]!=t[0]||e[1]!=t[1]);if(!Ce(sn.selStart,e)||!Ce(sn.selEnd,t)||sn.selFocusAtStart!=r){sn.selStart=e,sn.selEnd=t,sn.selFocusAtStart=r,Dn.repChanged=!0,Te(sn),hooks.callAll("aceSelectionChanged",{rep:sn,callstack:Dn,documentAttributeManager:dn});var o=Dn.docTextChanged;if(!o){var i=!Ie(Dn.type)&&u(Dn.type),a=pt();rn.scrollWhenCaretIsInTheLastLineOfViewportWhenNecessary(sn,i,a)}return!0}return!1}function Ie(e){return"setup"===e||"setBaseText"===e||"importText"===e}function Ae(e,t){var n=parent.parent.$('[data-key="'+e+'"]').find("a");n.toggleClass(Yt,t)}function Ne(e){return _.contains(jt,e)}function Te(e){_.each(jt,function(e){var t=dn.hasAttributeOnSelectionOrCaretPosition(e);Ae(e,t)})}function _e(e){if(browser.msie&&!e){var t={node:null,appendSpan:noop,prepareForAdd:noop,notifyAdded:noop,clearSpans:noop,finishUpdate:noop,lineMarker:0},n=un.createElement("div");t.node=n,t.notifyAdded=function(){n.innerHTML=" ",setAssoc(n,"shouldBeEmpty",!0),setAssoc(n,"unpasted",{}),n.innerHTML=""};var r="ace-line";t.appendSpan=function(e,t){!e&&t&&(r=Tt.addToLineClass(r,t))},t.clearSpans=function(){r=""};var o=function(){null!==r&&(n.className=r)};return t.prepareForAdd=o,t.finishUpdate=o,t.getInnerHTML=function(){return""},t}return Tt.createDomLine(e,pn,browser,un)}function Le(e){return e.replace(/[\n\r ]/g," ").replace(/\xa0/g," ").replace(/\t/g,"        ")}function Oe(e){return!!Bn[(e.tagName||"").toLowerCase()]}function Ke(){function e(e){if(void 0===c[e]){s.forIndices++;var t;if(0>e||e>=u)t=!0;else{var n=sn.lines.atIndex(e).key;t=q(n)||!1}c[e]=t}return c[e]}function t(t){return void 0===d[t]&&(s.consecutives++,d[t]=function(){var n=e(t-1),r=e(t);return n&&r?n===!0&&r===!0?!cn.firstChild:n===!0&&r.previousSibling?!1:r===!0&&n.nextSibling?!1:n===!0||r===!0?!0:n.nextSibling==r:!1}()),d[t]}function n(t){return!!e(t)}function r(e){var t=-1;return _.each(f,function(n,r){return e>=n[1]?!1:e<n[0]?!0:(t=r,!0)}),t}function o(e,t){var n=f[e][0],r=f[e][1];n+1==r?f.splice(e,1):t==n?f[e][0]++:t==r-1?f[e][1]--:f.splice(e,1,[n,t],[t+1,r])}function i(e,t){var n=f[e][0],r=f[e][1];f.splice(e,1,[n,t],[t,r])}function a(e){if(p[e])return!0;s.corrections++,p[e]=!0;var a=r(e),l=n(e);if(0>a)return l&&yn.debug("somehow lost clean line"),!0;if(l){var c=f[a][0],u=f[a][1],d=!1;return e>c&&n(e-1)&&!t(e)&&(i(a,e),d=!0),u>e+1&&n(e+1)&&!t(e+1)&&(i(a,e+1),d=!0),!d}return o(a,e),!1}function l(e,t){for(var n=0,r=e;t>n&&r>=0;)a(r)?n++:n=0,r--;for(n=0,r=e;t>n&&u>r;)a(r)?n++:n=0,r++}var s=Cn("getDirtyRanges",!1);s.forIndices=0,s.consecutives=0,s.corrections=0;var c={},u=sn.lines.length(),d={},f=[[-1,u+1]],p={};if(0===u)s.cancel(),t(0)||i(0,0);else{s.mark("topbot"),l(0,1),l(u-1,1),s.mark("obs");for(var h in Mn.cleanNodesNearChanges){var g=h.substring(1);if(sn.lines.containsKey(g)){var v=sn.lines.indexOfKey(g);l(v,2)}}s.mark("stats&calc"),s.literal(s.forIndices,"byidx"),s.literal(s.consecutives,"cons"),s.literal(s.corrections,"corr")}for(var m=[],x=0;x<f.length-1;x++)m.push([f[x][1],f[x+1][0]]);return s.end(),m}function De(e){var t={};t.nodeId=H(e),t.knownHTML=e.innerHTML,browser.msie&&(t.knownText=e.innerText),setAssoc(e,"dirtiness",t)}function Fe(e){var t=Cn("cleanCheck",!1);if(e.parentNode!=cn)return!0;var n=getAssoc(e,"dirtiness");return n?e.id!==n.nodeId?!0:browser.msie&&e.innerText!==n.knownText?!0:e.innerHTML!==n.knownHTML?!0:(t.end(),!1):!0}function Me(){var e=rn.getScrollY(),t=en.document,n=t.documentElement.clientHeight,r=Pe()+Re();return{top:e,bottom:e+n-r}}function Pe(){var e=parent.document.getElementsByTagName("iframe"),t=e[0].offsetTop;return t}function Re(){var e=parent.parent.document,t=e.getElementsByName("ace_outer"),n=parseInt($(t).css("padding-top"));return n}function $e(e){function t(e){return"a"==(e.tagName||"").toLowerCase()&&e.href}if(f("handleClick",function(){Pn.atMost(200)}),!e.ctrlKey&&2!=e.button&&3!=e.button){for(var n=e.target;n&&n.parentNode&&!t(n);)n=n.parentNode;if(n&&t(n)){try{var r=window.open(n.href,"_blank");r.focus()}catch(o){}e.preventDefault()}}Be()}function Be(){window.parent.parent.padeditbar&&window.parent.parent.padeditbar.toggleDropDown("none")}function He(){if(sn.selStart&&sn.selEnd){var e=sn.selStart[0],t=mt(e);if(t){var n=sn.lines.atIndex(e).text;t=/([a-z]+)([0-9]+)/.exec(t);var r=t[1],o=Number(t[2]);"*"===n&&"indent"!==r?o>1?xt(e,r+(o-1)):(xt(e,""),bt(e+1)):e+1<=sn.lines.length()&&(xe("\n"),xt(e+1,r+o))}else xe("\n"),re()}}function Ve(e){if(!(sn.selStart&&sn.selEnd||sn.selStart[0]==sn.selEnd[0]&&sn.selStart[1]==sn.selEnd[1]&&sn.selEnd[1]>1)&&1!=e)return!1;var t,n;t=sn.selStart[0],n=Math.max(t,sn.selEnd[0]-(0===sn.selEnd[1]?1:0));for(var r=[],o=t;n>=o;o++){var i=mt(o),a="indent",l=0;i&&(i=/([a-z]+)([0-9]+)/.exec(i),i&&(a=i[1],l=Number(i[2])));var s=Math.max(0,Math.min(Ht,l+(e?-1:1)));l!=s&&r.push([o,s>0?a+s:""])}return _.each(r,function(e){xt(e[0],e[1])}),!0}function Ue(e){Ve(e)||xe(Bt)}function We(e){var t=e||{},n=!1;if(sn.selStart){if(Z()){var r=ee(),o=te(),i=sn.lines.atIndex(r),a=i.text,l=i.lineMarker;if(/^ +$/.exec(a.substring(l,o))){var s=o-l,c=Bt.length,u=(s-1)%c+1;pe([r,o-u],[r,o],""),n=!0}}if(!n)if(Z()){var d=ee(),i=sn.lines.atIndex(d);if(te()<=i.lineMarker){var f=d>0?mt(d-1):"",p=mt(d),h=d>0&&sn.lines.atIndex(d-1),g=h&&h.text.length==h.lineMarker,v=dn.lineHasMarker(d);p?g&&!f?pe([d-1,h.text.length],[d,0],""):pe([d,0],[d,i.lineMarker],""):v&&h?pe([d-1,h.text.length],[d,i.lineMarker],""):d>0&&pe([d-1,h.text.length],[d,0],"")}else{var m=ne();if(m>0)if(t.metaKey||t.ctrlKey||t.altKey){for(var x=m-1;x>i.lineMarker&&qe(sn.alltext.charAt(x-1));)x--;fe(x,m,"")}else fe(m-1,m,"")}}else xe("")}var b=ee();-1!=b&&null===bt(b+1)&&bt(b)}function qe(e){return!!Hn.exec(e)}function ze(e){if(fn){var t=e.type,n=e.charCode,r=e.keyCode,o=e.which,i=e.altKey,a=e.shiftKey,l=document.getSelection(),s=l.focusNode.parentNode.offsetTop|l.focusNode.offsetTop;if(l.focusNode.wholeText)var c=l.focusNode.parentNode.offsetHeight;else var c=l.focusNode.offsetHeight;var u=parent.parent.$("#chaticon").height();c=2*c+u;var d=Me(),p=d.bottom-d.top-c,h=s-d.top;h>p?parent.parent.$("#chaticon").css("opacity",".3"):parent.parent.$("#chaticon").css("opacity","1");var g=!(n||"keyup"!=t&&"keydown"!=t||16!=r&&17!=r&&18!=r&&20!=r&&224!=r&&91!=r);if(!(g||13==r&&browser.opera&&"keypress"==t)){var v=!1,m=browser.msie||browser.safari||browser.chrome||browser.firefox?"keydown"==t:"keypress"==t,x=browser.msie||browser.safari||browser.chrome||browser.firefox?"keydown"==t:"keypress"==t,b=!1;f("handleKeyEvent",function(){if("keypress"==t||m&&13==r)an(e)||(e.preventDefault(),b=!0);else{if("Dead"===e.key)return b=!0,!0;"keydown"==t&&on(e)}if(!b){var l=hooks.callAll("aceKeyEvent",{callstack:Dn,editorInfo:Jt,rep:sn,documentAttributeManager:dn,evt:e});l&&(v=_.contains(l,!0));var s=parent.parent.clientVars.padShortcutEnabled;if(!v&&i&&m&&120==r&&s.altF9){var c=parent.parent.$("#editbar").children("ul").first().children().first().children().first().children().first();$(this).blur(),c.focus(),e.preventDefault()}if(!v&&i&&67==r&&"keydown"===t&&s.altC&&($(this).blur(),parent.parent.chat.show(),parent.parent.$("#chatinput").focus(),e.preventDefault()),!v&&e.ctrlKey&&a&&50==r&&"keydown"===t&&s.cmdShift2){var u=sn.selEnd[0],d=sn.alines[u],f=sn.apool,p=null;if(d)for(var h=[],g=[],y=Lt.opIterator(d);y.hasNext();){var S=y.next();authorId=Lt.opAttributeValue(S,"author",f),-1===h.indexOf(authorId)&&""!==authorId&&h.push(authorId)}if(0===h.length)var w="No author information is available";else{var C=parent.parent.pad.userList(),E={};h.forEach(function(e){return C.forEach(function(t){t.userId===e&&(E=parent.parent.clientVars.userId===e?{name:"Me"}:t)}),E?(p=E.name,p||(p="Unknown"),void g.push(p)):void(p="Unknown")})}if(1===h.length)var w="The author of this line is "+g;if(h.length>1)var w="The authors of this line are "+g.join(" & ");parent.parent.$.gritter.add({title:"Line Authors",text:w,sticky:!1,time:"4000"})}if(!v&&m&&8==r&&s["delete"]&&(B(3),e.preventDefault(),We(e),v=!0),!v&&m&&13==r&&s["return"]&&(B(4),e.preventDefault(),He(),kn.setTimeout(function(){en.scrollBy(-100,0)},0),v=!0),!v&&m&&27==r&&s.esc&&(B(4),e.preventDefault(),v=!0),!v&&x&&"s"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&!e.altKey&&s.cmdS){e.preventDefault();var k=parent.parent.$("#revisionlink").css("background");parent.parent.$("#revisionlink").css({background:"lightyellow"}),kn.setTimeout(function(){parent.parent.$("#revisionlink").css({background:k})},1e3),parent.parent.pad.collabClient.sendMessage({type:"SAVE_REVISION"}),v=!0}if(v||!m||9!=r||e.metaKey||e.ctrlKey||!s.tab||(B(5),e.preventDefault(),Ue(e.shiftKey),v=!0),!v&&x&&"z"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&!e.altKey&&s.cmdZ&&(B(6),e.preventDefault(),Ye(e.shiftKey?"redo":"undo"),v=!0),!v&&x&&"y"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&s.cmdY&&(B(10),e.preventDefault(),Ye("redo"),v=!0),!v&&x&&"b"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&s.cmdB&&(B(13),e.preventDefault(),me("bold"),v=!0),!v&&x&&"i"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&s.cmdI&&(B(14),e.preventDefault(),me("italic"),v=!0),!v&&x&&"u"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&s.cmdU&&(B(15),e.preventDefault(),me("underline"),v=!0),!v&&x&&"5"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&e.altKey!==!0&&s.cmd5&&(B(13),e.preventDefault(),me("strikethrough"),v=!0),!v&&x&&"l"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&s.cmdShiftL&&(B(9),e.preventDefault(),St(),v=!0),!v&&x&&("n"==String.fromCharCode(o).toLowerCase()&&s.cmdShiftN||1==String.fromCharCode(o)&&s.cmdShift1)&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&(B(9),e.preventDefault(),wt(),v=!0),!v&&x&&"c"==String.fromCharCode(o).toLowerCase()&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&s.cmdShiftC&&(B(9),e.preventDefault(),Fn.clearauthorship()),!v&&x&&"h"==String.fromCharCode(o).toLowerCase()&&e.ctrlKey&&s.cmdH&&(B(20),e.preventDefault(),We(),v=!0),36==e.which&&1==e.ctrlKey&&s.ctrlHome&&rn.setScrollY(0),(33==e.which||34==e.which)&&"keydown"==t&&!e.ctrlKey){e.preventDefault();var I=rn.getVisibleLineRange(sn),A=sn.selStart[0]-I[0];0>A&&(A=0);var N=34===e.which,T=33===e.which;kn.setTimeout(function(){var e=rn.getVisibleLineRange(sn),t=sn.lines.length(),n=e[1]-e[0];T&&s.pageUp&&(sn.selEnd[0]=sn.selEnd[0]-n,sn.selStart[0]=sn.selStart[0]-n),N&&s.pageDown&&sn.selEnd[0]>=I[0]&&(sn.selStart[0]=I[1]-1,sn.selEnd[0]=I[1]-1),sn.selEnd[0]<0&&(sn.selEnd[0]=0),sn.selStart[0]<0&&(sn.selStart[0]=0),sn.selEnd[0]>=t&&(sn.selEnd[0]=t-1),Qe();var r=document.getSelection(),o=r.focusNode.parentNode.offsetTop||r.focusNode.offsetTop;-1===o&&(o=r.focusNode.offsetTop),rn.setScrollY(o)},200)}if((37==e.which||38==e.which||39==e.which||40==e.which)&&!je(t)){var L=Je();if(L){var O=38===e.which,K=pt();rn.scrollWhenPressArrowKeys(O,sn,K)}}}if("keydown"==t)Pn.atLeast(500);else if("keypress"==t)Pn.atLeast(500);else if("keyup"==t){var D=0;Pn.atLeast(D),Pn.atMost(D)}var F=browser.firefox&&e.altKey&&0===n&&0===r,M=browser.safari&&e.altKey&&229==r;(Vn||F||M)&&(Pn.atLeast(3e3),Vn=!0),v||Vn||qn||"keyup"!=t&&j(),"keyup"==t&&(Vn=!1)})}}}function je(e){var t=!1;return"keyup"==e?Un=!0:"keydown"==e&&Un&&(t=!0,Un=!1),!t}function Ye(e){if(Ft.enabled){var t;if("undo"==e&&(t="performUndo"),
"redo"==e&&(t="performRedo"),t){var n=Dn.editEvent.eventType;Dn.startNewEvent(e),Ft[t](function(e,t){e&&se(e),t&&Ee(de(t.selStart),de(t.selEnd),t.selFocusAtStart);var r=Dn.startNewEvent(n,!0);return r})}}}function Qe(){var e=sn.selStart,t=sn.selEnd;if(!e||!t)return void Ze(null);var n={},r=[e[0],e[1]];n.startPoint=oe(r);var o=[t[0],t[1]];n.endPoint=oe(o),n.focusAtStart=!!sn.selFocusAtStart,Ze(n)}function Xe(e){return isNodeText(e)?e.nodeValue.length:1}function Ge(){var e;try{e=un.selection}catch(t){}if(!e)return!1;var n;try{n=e.createRange()}catch(t){}return!!n}function Je(){function e(e){for(;e&&(!e.tagName||"body"!=e.tagName.toLowerCase());)e=e.parentNode;return!!e}function t(t,n){if(!e(t))return{node:cn,index:0,maxIndex:1};var r=t,o=r.childNodes.length;if(isNodeText(r))return{node:r,index:n,maxIndex:r.nodeValue.length};if(0===o)return{node:r,index:0,maxIndex:1};if(n==o){var i=r.childNodes.item(o-1),a=Xe(i);return{node:i,index:a,maxIndex:a}}var i=r.childNodes.item(n),a=Xe(i);return{node:i,index:0,maxIndex:a}}if(browser.msie){var n;try{n=un.selection}catch(r){}if(!n)return null;var o;try{o=n.createRange()}catch(r){}if(!o)return null;var i=o.parentElement();if(i.ownerDocument!=un)return null;var a=function(){return un.body.createTextRange()},l=function(e){var t=a();return t.moveToElementText(e),t},s=function(e){var t=e.parentElement(),n=-1,r=t.childNodes.length,o=l(t);if(0===e.compareEndPoints("StartToStart",o))return{node:t,index:0,maxIndex:1};if(0===e.compareEndPoints("EndToEnd",o))return Oe(t)&&t.nextSibling?{node:t.nextSibling,index:0,maxIndex:1}:{node:t,index:1,maxIndex:1};if(0===t.childNodes.length)return{node:t,index:0,maxIndex:1};for(var i=0;i<t.childNodes.length;i++){var a=t.childNodes.item(i);if(!isNodeText(a)){var s=l(a),c=e.compareEndPoints("StartToStart",s),u=e.compareEndPoints("EndToEnd",s);if(c>=0&&0>=u){var d=0;return c>0&&(d=1),{node:a,index:d,maxIndex:1}}u>0?i>n&&(n=i,o.setEndPoint("StartToEnd",s)):0>c&&r>i&&(r=i,o.setEndPoint("EndToStart",s))}}if(r-n==1)return n>=0?{node:t.childNodes.item(n),index:1,maxIndex:1}:{node:t.childNodes.item(r),index:0,maxIndex:1};for(var f=0,p=e.duplicate(),h=binarySearchInfinite(40,function(e){var t=e-f,n=Math.abs(p.move("character",-t));return p.move("character",-1)&&p.move("character",1),0>t?f-=n:f+=n,p.compareEndPoints("StartToStart",o)<=0}),g=n+1,v=h;r>g;){var m=t.childNodes.item(g);if(v<=m.nodeValue.length)return{node:m,index:v,maxIndex:m.nodeValue.length};v-=m.nodeValue.length,g++}var m=t.childNodes.item(g-1);return{node:m,index:m.nodeValue.length,maxIndex:m.nodeValue.length}},c={};if(0===o.compareEndPoints("StartToEnd",o)){var u=s(o);c.startPoint=u,c.endPoint={node:u.node,index:u.index,maxIndex:u.maxIndex}}else{var d=o.duplicate();d.collapse(!0);var f=o.duplicate();f.collapse(!1),c.startPoint=s(d),c.endPoint=s(f)}return c}var n=window.getSelection();if(n&&"None"!=n.type&&0!==n.rangeCount){var p=n.getRangeAt(0),c={};return c.startPoint=t(p.startContainer,p.startOffset),c.endPoint=t(p.endContainer,p.endOffset),c.focusAtStart=(p.startContainer!=p.endContainer||p.startOffset!=p.endOffset)&&n.anchorNode&&n.anchorNode==p.endContainer&&n.anchorOffset==p.endOffset,c.startPoint.node.ownerDocument!==window.document?null:c}return null}function Ze(e){function t(e){return{node:e.node,index:e.index,maxIndex:e.maxIndex}}function n(e,t){for(;t.firstChild&&!isNodeText(t.firstChild);)t=t.firstChild;e.moveToElementText(t)}function r(){return un.body.createTextRange()}function o(e,t){isNodeText(t)?t.previousSibling&&!isNodeText(t.previousSibling)?i(e,t.previousSibling):o(e,t.parentNode):(n(e,t),e.move("character",1)&&e.move("character",-1),e.collapse(!0))}function i(e,t){isNodeText(t)?(o(e,t),e.move("character",t.nodeValue.length)):(n(e,t),e.collapse(!1))}function a(e){var t=r(),n=e.node;return isNodeText(n)?(o(t,n),t.move("character",e.index)):0===e.index?o(t,n):i(t,n),t}function l(e){var t;try{t=un.selection}catch(n){}if(!t)return!1;var r=t.createRange();return r.parentElement().ownerDocument!=un?!1:0!==e.compareEndPoints("StartToStart",r)?!1:0===e.compareEndPoints("EndToEnd",r)}function s(e){function n(){for(;r.node.childNodes.length>0;)if(0===r.index)r.node=r.node.firstChild,r.maxIndex=Xe(r.node);else{if(r.index!=r.maxIndex)break;r.node=r.node.lastChild,r.maxIndex=Xe(r.node),r.index=r.maxIndex}}var r=t(e);if(p){if(isNodeText(r.node)&&r.index==r.maxIndex){for(var o=r.node;!o.nextSibling&&o!=cn&&o.parentNode!=cn;)o=o.parentNode;!o.nextSibling||"string"==typeof o.nextSibling.tagName&&"br"==o.nextSibling.tagName.toLowerCase()||o==r.node||o==cn||o.parentNode==cn||(r.node=o.nextSibling,r.maxIndex=Xe(r.node),r.index=0,n())}isNodeText(r.node)||n()}return isNodeText(r.node)?{container:r.node,offset:r.index}:{container:r.node.parentNode,offset:et(r.node)+r.index}}if(browser.msie)if(un.body.scrollHeight,e){if(!Ge())return;var c=t(e.startPoint),u=t(e.endPoint);u.index==u.maxIndex&&u.node.nextSibling&&(u.node=u.node.nextSibling,u.index=0,u.maxIndex=Xe(u.node));var d=a(c);d.setEndPoint("EndToEnd",a(u)),l(d)||d.select()}else try{un.selection.empty()}catch(f){}else{var p,h=window.getSelection();if(h&&(h.removeAllRanges(),e)){p=e.startPoint.node===e.endPoint.node&&e.startPoint.index===e.endPoint.index;var g=s(e.startPoint),v=s(e.endPoint);if(!p&&e.focusAtStart&&h.collapse&&h.extend)h.collapse(v.container,v.offset),h.extend(g.container,g.offset);else{var d=un.createRange();d.setStart(g.container,g.offset),d.setEnd(v.container,v.offset),h.removeAllRanges(),h.addRange(d)}}}}function et(e){for(var t=0;e.previousSibling;)t++,e=e.previousSibling;return t}function tt(){function e(e,t,n){e[t]!=n&&(e[t]=n)}if(0!==ht()&&0!==pt()){var t=tn.firstChild.offsetWidth,n=t+Ut;Wt>n&&(n=Wt),vn=zt,hn&&(vn+=n+Vt),e(Zt.style,"left",vn+"px"),e(tn.style,"width",n+"px");for(var r=0;2>r;r++){var o=cn.clientHeight,i=browser.msie?cn.createTextRange().boundingWidth:cn.clientWidth,a=pt()-xn-mn,l=ht()-vn-bn;a>o?(o=a,browser.msie&&e(en.document.documentElement.style,"overflowY","auto")):browser.msie&&e(en.document.documentElement.style,"overflowY","scroll"),pn?i=l:l>i&&(i=l),e(Zt.style,"height",o+"px"),e(Zt.style,"width",i+"px"),e(tn.style,"height",o+"px")}if(browser.firefox)if(pn)e(cn.style,"height","");else{var s=cn,c=a+"px";e(s.style,"height",c)}S(),$(tn).addClass("sidedivdelayed")}}function nt(){_.each(Wn,function(e){e()})}function rt(e){function t(e,t,n){return String(e[t]).toLowerCase()!=n?(e[t]=n,!0):!1}try{if(browser.msie||browser.safari)t(cn,"contentEditable",e?"true":"false");else{var n=t(un,"designMode",e?"on":"off");n&&e&&browser.opera&&at()}return!0}catch(r){return!1}}function ot(e){var t=window.clipboardData&&window.clipboardData.getData("Text");t&&un.selection}function it(e){"compositionstart"==e.type?qn=!0:"compositionend"==e.type&&(qn=!1)}function at(){$(document).on("keydown",ze),$(document).on("keypress",ze),$(document).on("keyup",ze),$(document).on("click",$e),$(en.document).on("click",Be),$(cn).on("blur",dt),browser.msie&&$(document).on("click",st),browser.msie&&$(cn).on("paste",ot),$(cn).on("paste",function(e){(e.target.a||"a"===e.target.localName)&&e.preventDefault(),hooks.callAll("acePaste",{editorInfo:Jt,rep:sn,documentAttributeManager:dn,e:e})}),$(document).on("drop",function(e){(e.target.a||"a"===e.target.localName)&&e.preventDefault();var t=Je();if(t){var n=lt(t.startPoint.node),r=lt(t.endPoint.node),o=n.previousSibling,i=r.nextSibling,a=o||i;a.appendChild(document.createElement("style"))}hooks.callAll("aceDrop",{editorInfo:Jt,rep:sn,documentAttributeManager:dn,e:e})}),browser.msie&&parseInt(browser.version<=9)||!document.documentElement||($(document.documentElement).on("compositionstart",it),$(document.documentElement).on("compositionend",it))}function lt(e){if(!e||e==cn)return null;for(;e.parentNode!=cn;)e=e.parentNode;return e}function st(e){"html"==(e.target.tagName||"").toLowerCase()&&e.pageY>cn.clientHeight&&f("handleOuterClick",function(){if(B(11),Z()){var e=sn.lines.length()-1,t=sn.lines.atIndex(e).text.length;Ee([e,t],[e,t])}})}function ct(e,t,n){n?$(e).addClass(t):$(e).removeClass(t)}function ut(){window.focus()}function dt(e){browser.msie&&Ze(null)}function ft(e){function t(e){return e.offsetLeft}function n(e){return e.offsetLeft+e.offsetWidth}var r=e.node,o=e.index;if(isNodeText(r)){var i,a=o,l=r.nodeValue.length-o;for(i=r.previousSibling;i&&isNodeText(i);i=i.previousSibling)a+=i.nodeValue;var s=i?n(i):t(r.parentNode);for(i=r.nextSibling;i&&isNodeText(i);i=i.nextSibling)l+=i.nodeValue;var c=i?t(i):n(r.parentNode),u=a/(a+l),d=s+u*(c-s);return Math.round(d)}return 0===o?t(r):n(r)}function pt(){var e,t=en,n=t.document;return e=browser.opera?t.innerHeight:n.documentElement.clientHeight,e?e:Number(Jt.frame.parentNode.style.height.replace(/[^0-9]/g,"")||0)}function ht(){var e=en,t=e.document;return t.documentElement.clientWidth}function gt(e){var t=en;en.document;e+=vn;var n=e-t.scrollX,r=t.scrollX+ht()-e;0>n?t.scrollBy(n,0):0>r&&t.scrollBy(-r+1,0)}function vt(){if(sn.selStart){tt();var e=pt();if(rn.scrollNodeVerticallyIntoView(sn,e),!pn){var t=Je();if(t){var n=t.focusAtStart?t.startPoint:t.endPoint,r=ft(n);gt(r),tt()}}}}function mt(e){return dn.getAttributeOnLine(e,zn)}function xt(e,t){""==t?(dn.removeAttributeOnLine(e,zn),dn.removeAttributeOnLine(e,"start")):dn.setAttributeOnLine(e,zn,t),null==bt(e+1)&&bt(e)}function bt(e){function t(e,n){for(var i,a=1,l=n;i=mt(e);){if(i=/([a-z]+)([0-9]+)/.exec(i),l=Number(i[2]),isNaN(l)||"indent"==i[0])return e;if(l==n)Ot.buildKeepRange(sn,r,o,o=[e,0]),Ot.buildKeepRange(sn,r,o,o=[e,1],[["start",a]],sn.apool),a++,e++;else{if(n>l)return e;e=t(e,n+1)}}return e}var n=mt(e);if(!n)return null;if(n=/([a-z]+)[0-9]+/.exec(n),"indent"==n[1])return null;for(;e-1>=0&&(n=mt(e-1))&&(n=/([a-z]+)[0-9]+/.exec(n),"indent"!=n[1]);)e--;var r=Lt.builder(sn.lines.totalWidth()),o=[0,0];t(e,1);var i=r.toString();Lt.isIdentity(i)||se(i)}function yt(e){if(sn.selStart&&sn.selEnd){var t,n;t=sn.selStart[0],n=Math.max(t,sn.selEnd[0]-(0===sn.selEnd[1]?1:0));for(var r=!0,o=t;n>=o;o++){var i=mt(o);if(!i||i.slice(0,e.length)!=e){r=!1;break}}for(var a=[],o=t;n>=o;o++){var l="",s=0,i=/([a-z]+)([0-9]+)/.exec(mt(o));i&&(l=i[1],s=Number(i[2]));var l=mt(o);r&&1!=s?s-=1:l&&!r&&(s+=1),a.push([o,r?"indent"+s:l?e+s:e+"1"])}_.each(a,function(e){xt(e[0],e[1])})}}function St(){yt("bullet")}function wt(){yt("number")}function Ct(){jn=1,tn.innerHTML='<table border="0" cellpadding="0" cellspacing="0" align="right"><tr><td id="sidedivinner" class="sidedivinner"><div>1</div></td></tr></table>',Yn=en.document.getElementById("sidedivinner"),$(tn).addClass("sidediv")}function Et(){var e=sn.lines.length();1>e&&(e=1);var t=Yn.firstChild,n=un.body.firstChild,r=0;if(Dn&&Dn.domClean)for(;t&&n&&!(r>jn);){var o=n.clientHeight||n.offsetHeight;if(n.nextSibling&&(o=n===un.body.firstChild?n.nextSibling.offsetTop-parseInt(window.getComputedStyle(un.body).getPropertyValue("padding-top").split("px")[0]):n.nextSibling.offsetTop-n.offsetTop),o){var i=o+"px";t.style.height!=i&&(t.style.height=i)}t=t.nextSibling,n=n.nextSibling,r++}if(e!=jn){for(var a=Yn,l=en.document,s=l.createDocumentFragment();e>jn;){jn++;var r=jn,c=l.createElement("DIV");if(n){var o=n.clientHeight||n.offsetHeight;n.nextSibling&&(o=n.nextSibling.offsetTop-n.offsetTop)}o&&(c.style.height=o+"px"),c.appendChild(l.createTextNode(String(r))),s.appendChild(c),n&&(n=n.nextSibling)}for(a.appendChild(s);jn>e;)a.removeChild(a.lastChild),jn--}}var kt=require("./changesettracker").makeChangesetTracker,It=require("./colorutils").colorutils,At=require("./contentcollector").makeContentCollector,Nt=require("./cssmanager").makeCSSManager,Tt=require("./domline").domline,_t=require("./AttributePool"),Lt=require("./Changeset"),Ot=require("./ChangesetUtils"),Kt=require("./linestylefilter").linestylefilter,Dt=require("./skiplist"),Ft=require("./undomodule").undoModule,Mt=require("./AttributeManager"),Pt=require("./scroll"),Rt=!1,$t=!1,Bt="    ",Ht=16,Vt=4,Ut=4,Wt=20,qt=8,zt=8,jt=["bold","italic","underline","strikethrough"],Yt="selected",Qt=[],Xt="",Gt=!1,Jt=parent.editorInfo,Zt=window.frameElement,en=Zt.ace_outerWin;Zt.ace_outerWin=null;var tn=Zt.nextSibling,nn=tn.nextSibling;Ct();var rn=Pt.init(en),on=noop,an=function(){return!0},ln=noop,sn={lines:new Dt,selStart:null,selEnd:null,selFocusAtStart:!1,alltext:"",alines:[],apool:new _t};Ft.enabled&&(Ft.apool=sn.apool);var cn,un,dn,fn=!0,pn=!0,hn=!0,gn=!0,vn=Wt+Vt+zt,mn=qt,xn=0,bn=0,yn=Rt&&window.console;if(!window.console){var Sn=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];yn={};for(var wn=0;wn<Sn.length;++wn)yn[Sn[wn]]=noop}var Cn=window.PROFILER;Cn||(Cn=function(){return{start:noop,mark:noop,literal:noop,end:noop,cancel:noop}});var En=noop;window.dmesg=noop;var kn=parent,In="monospace",An=12,Nn=null,Tn=null,_n=null,Ln=kt(kn,sn.apool,{withCallbacks:function(e,t){f(e,function(){B(1),t({setDocumentAttributedText:function(e){E(e)},applyChangesetToDocument:function(e,t){var n=Dn.editEvent.eventType;Dn.startNewEvent("nonundoable"),se(e,t),Dn.startNewEvent(n)}})})}}),On={};Jt.ace_getAuthorInfos=n,Jt.ace_getRep=function(){return sn},Jt.ace_getAuthor=function(){return Xt};var Kn={applyChangesToBase:1};_.each(hooks.callAll("aceRegisterNonScrollableEditEvents"),function(e){Kn[e]=1});var Dn=null;Jt.ace_inCallStack=d,Jt.ace_inCallStackIfNecessary=f;var Fn={clearauthorship:function(e){sn.selStart&&sn.selEnd&&!Z()?ge("author",""):e?e():he(0,sn.alltext.length,[["author",""]])}};Jt.ace_focus=ut,Jt.ace_importText=w,Jt.ace_importAText=C,Jt.ace_exportText=A,Jt.ace_editorChangedSize=N,Jt.ace_setOnKeyPress=T,Jt.ace_setOnKeyDown=L,Jt.ace_setNotifyDirty=O,Jt.ace_dispose=p,Jt.ace_getFormattedCode=K,Jt.ace_setEditable=y,Jt.ace_execCommand=D,Jt.ace_replaceRange=F,Jt.ace_getAuthorInfos=n,Jt.ace_performDocumentReplaceRange=pe,Jt.ace_performDocumentReplaceCharRange=fe,Jt.ace_renumberList=bt,Jt.ace_doReturnKey=He,Jt.ace_isBlockElement=Oe,Jt.ace_getLineListType=mt,Jt.ace_callWithAce=function(e,t,n){var r=function(){return e(Jt)};if(void 0!==n){var o=r;r=function(){Jt.ace_fastIncorp(9),o()}}return void 0!==t?Jt.ace_inCallStack(t,r):r()},Jt.ace_setProperty=function(e,t){var n=function(e,t){return function(n){ct(e,t,!!n)}},r={wraps:g,showsauthorcolors:n(cn,"authorColors"),showsuserselections:n(cn,"userSelections"),showslinenumbers:function(e){hn=!!e,ct(tn,"sidedivhidden",!hn),ct(tn.parentNode,"sidediv-hidden",!hn),tt()},grayedout:n(en.document.body,"grayedout"),dmesg:function(){En=window.dmesg=t},userauthor:function(e){Xt=String(e),dn.author=Xt},styled:v,textface:m,textsize:x,rtlistrue:function(e){ct(cn,"rtl",e),ct(cn,"ltr",!e),document.documentElement.dir=e?"rtl":"ltr"}},o=r[e.toLowerCase()];void 0!==o&&o(t)},Jt.ace_setBaseText=function(e){Ln.setBaseText(e)},Jt.ace_setBaseAttributedText=function(e,t){s(),Ln.setBaseAttributedText(e,t)},Jt.ace_applyChangesToBase=function(e,t,n){Ln.applyChangesToBase(e,t,n)},Jt.ace_prepareUserChangeset=function(){return Ln.prepareUserChangeset()},Jt.ace_applyPreparedChangesetToBase=function(){Ln.applyPreparedChangesetToBase()},Jt.ace_setUserChangeNotificationCallback=function(e){Ln.setUserChangeNotificationCallback(e)},Jt.ace_setAuthorInfo=function(e,t){o(e,t)},Jt.ace_setAuthorSelectionRange=function(e,t,n){Ln.setAuthorSelectionRange(e,t,n)},Jt.ace_getUnhandledErrors=function(){return Qt.slice()},Jt.ace_getDocument=function(){return un},Jt.ace_getDebugProperty=function(e){if("debugger"==e)window.eval("debugger");else{if("rep"==e)return sn;if("window"==e)return window;if("document"==e)return document}},Jt.ace_fastIncorp=B;var Mn,Pn=R(function(){return qn?void Pn.atLeast(500):void f("idleWorkTimer",function(){var e=P(250),t=!1,n=!1;try{if(Q(e),e())return;if(Et(),e())return;rn.getVisibleCharRange(sn),[0,sn.lines.totalWidth()];t=!0,n=!0}finally{if(n)Pn.atMost(1e3);else if(t)Pn.atMost(500);else{var r=Math.round(e.elapsed()/2);100>r&&(r=100),Pn.atMost(r)}}})}),Rn=1;W();var $n={bold:!0,italic:!0,underline:!0,strikethrough:!0,list:!0};Jt.ace_isCaret=Z,Jt.ace_caretLine=ee,Jt.ace_caretColumn=te,Jt.ace_caretDocChar=ne,Jt.ace_getLineAndCharForPoint=ae,Jt.ace_performDocumentApplyAttributesToCharRange=he,Jt.ace_setAttributeOnSelection=ge,Jt.ace_getAttributeOnSelection=ve,Jt.ace_toggleAttributeOnSelection=me,Jt.ace_performSelectionChange=Ee;var Bn={div:1,p:1,pre:1,li:1,ol:1,ul:1};_.each(hooks.callAll("aceRegisterBlockElements"),function(e){Bn[e]=1}),Jt.ace_doIndentOutdent=Ve;var Hn=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/;Jt.ace_isWordChar=qe;var Vn=!1,Un=!0;Jt.ace_doUndoRedo=Ye,Jt.ace_updateBrowserSelectionFromRep=Qe;var Wn=[],qn=!1;Jt.ace_getInInternationalComposition=function(){return qn};var zn="list";Jt.ace_doInsertUnorderedList=St,Jt.ace_doInsertOrderedList=wt;var jn,Yn;dn=new Mt(sn,se),Jt.ace_performDocumentApplyAttributesToRange=function(){return dn.setAttributesOnRange.apply(dn,arguments)},this.init=function(){$(document).ready(function(){un=document,d("setup",function(){var e=un.getElementById("innerdocbody");for(cn=e,browser.firefox&&$(cn).addClass("mozilla"),browser.safari&&$(cn).addClass("safari"),browser.msie&&$(cn).addClass("msie"),ct(cn,"authorColors",!0),ct(cn,"doesWrap",pn),t(),S();cn.firstChild;)cn.removeChild(cn.firstChild);var n=le("");be(0,sn.lines.length(),[n]),J(null,[n.domInfo],null),sn.alines=Lt.splitAttributionLines(Lt.makeAttribution("\n"),"\n"),at()}),hooks.callAll("aceInitialized",{editorInfo:Jt,rep:sn,documentAttributeManager:dn}),kn.setTimeout(function(){parent.readyFunc()},0),$t=!0})}}var _,$,jQuery,plugins,Ace2Common,browser=require("./browser");browser.msie&&parseInt(browser.version)>=11&&(delete browser.msie,browser.chrome=!0,browser.modernIE=!0),Ace2Common=require("./ace2_common"),plugins=require("ep_etherpad-lite/static/js/pluginfw/client_plugins"),$=jQuery=require("./rjquery").$,_=require("./underscore");var isNodeText=Ace2Common.isNodeText,getAssoc=Ace2Common.getAssoc,setAssoc=Ace2Common.setAssoc,isTextNode=Ace2Common.isTextNode,binarySearchInfinite=Ace2Common.binarySearchInfinite,htmlPrettyEscape=Ace2Common.htmlPrettyEscape,noop=Ace2Common.noop,hooks=require("./pluginfw/hooks");exports.init=function(){var e=new Ace2Inner;e.init()};
}
, "ep_etherpad-lite/static/js/browser.js": function (require, exports, module) {
!function(e,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define(i):this[e]=i()}("bowser",function(){function e(e){function o(i){var o=e.match(i);return o&&o.length>1&&o[1]||""}function s(i){var o=e.match(i);return o&&o.length>1&&o[2]||""}var r,n=o(/(ipod|iphone|ipad)/i).toLowerCase(),t=/like android/i.test(e),a=!t&&/android/i.test(e),d=/CrOS/.test(e),m=/silk/i.test(e),v=/sailfish/i.test(e),b=/tizen/i.test(e),c=/(web|hpw)os/i.test(e),l=/windows phone/i.test(e),f=!l&&/windows/i.test(e),p=!n&&!m&&/macintosh/i.test(e),h=!a&&!v&&!b&&!c&&/linux/i.test(e),w=o(/edge\/(\d+(\.\d+)?)/i),k=o(/version\/(\d+(\.\d+)?)/i),u=/tablet/i.test(e),g=!u&&/[^-]mobi/i.test(e);/opera|opr/i.test(e)?r={name:"Opera",opera:i,version:k||o(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?r={name:"Yandex Browser",yandexbrowser:i,version:k||o(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:l?(r={name:"Windows Phone",windowsphone:i},w?(r.msedge=i,r.version=w):(r.msie=i,r.version=o(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?r={name:"Internet Explorer",msie:i,version:o(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:d?r={name:"Chrome",chromeos:i,chromeBook:i,chrome:i,version:o(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(e)?r={name:"Microsoft Edge",msedge:i,version:w}:/chrome|crios|crmo/i.test(e)?r={name:"Chrome",chrome:i,version:o(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:n?(r={name:"iphone"==n?"iPhone":"ipad"==n?"iPad":"iPod"},k&&(r.version=k)):v?r={name:"Sailfish",sailfish:i,version:o(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?r={name:"SeaMonkey",seamonkey:i,version:o(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel/i.test(e)?(r={name:"Firefox",firefox:i,version:o(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(r.firefoxos=i)):m?r={name:"Amazon Silk",silk:i,version:o(/silk\/(\d+(\.\d+)?)/i)}:a?r={name:"Android",version:k}:/phantom/i.test(e)?r={name:"PhantomJS",phantom:i,version:o(/phantomjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?r={name:"BlackBerry",blackberry:i,version:k||o(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:c?(r={name:"WebOS",webos:i,version:k||o(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(r.touchpad=i)):r=/bada/i.test(e)?{name:"Bada",bada:i,version:o(/dolfin\/(\d+(\.\d+)?)/i)}:b?{name:"Tizen",tizen:i,version:o(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||k}:/safari/i.test(e)?{name:"Safari",safari:i,version:k}:{name:o(/^(.*)\/(.*) /),version:s(/^(.*)\/(.*) /)},!r.msedge&&/(apple)?webkit/i.test(e)?(r.name=r.name||"Webkit",r.webkit=i,!r.version&&k&&(r.version=k)):!r.opera&&/gecko\//i.test(e)&&(r.name=r.name||"Gecko",r.gecko=i,r.version=r.version||o(/gecko\/(\d+(\.\d+)?)/i)),r.msedge||!a&&!r.silk?n?(r[n]=i,r.ios=i):f?r.windows=i:p?r.mac=i:h&&(r.linux=i):r.android=i;var y="";r.windowsphone?y=o(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):n?(y=o(/os (\d+([_\s]\d+)*) like mac os x/i),y=y.replace(/[_\s]/g,".")):a?y=o(/android[ \/-](\d+(\.\d+)*)/i):r.webos?y=o(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):r.blackberry?y=o(/rim\stablet\sos\s(\d+(\.\d+)*)/i):r.bada?y=o(/bada\/(\d+(\.\d+)*)/i):r.tizen&&(y=o(/tizen[\/\s](\d+(\.\d+)*)/i)),y&&(r.osversion=y);var x=y.split(".")[0];return u||"ipad"==n||a&&(3==x||4==x&&!g)||r.silk?r.tablet=i:(g||"iphone"==n||"ipod"==n||a||r.blackberry||r.webos||r.bada)&&(r.mobile=i),r.msedge||r.msie&&r.version>=10||r.yandexbrowser&&r.version>=15||r.chrome&&r.version>=20||r.firefox&&r.version>=20||r.safari&&r.version>=6||r.opera&&r.version>=10||r.ios&&r.osversion&&r.osversion.split(".")[0]>=6||r.blackberry&&r.version>=10.1?r.a=i:r.msie&&r.version<10||r.chrome&&r.version<20||r.firefox&&r.version<20||r.safari&&r.version<6||r.opera&&r.version<10||r.ios&&r.osversion&&r.osversion.split(".")[0]<6?r.c=i:r.x=i,r}var i=!0,o=e("undefined"!=typeof navigator?navigator.userAgent:"");return o.test=function(e){for(var i=0;i<e.length;++i){var s=e[i];if("string"==typeof s&&s in o)return!0}return!1},o._detect=e,o});
}
, "ep_etherpad-lite/static/js/AttributePool.js": function (require, exports, module) {
var AttributePool=function(){this.numToAttrib={},this.attribToNum={},this.nextNum=0};AttributePool.prototype.putAttrib=function(t,r){var i=String(t);if(i in this.attribToNum)return this.attribToNum[i];if(r)return-1;var o=this.nextNum++;return this.attribToNum[i]=o,this.numToAttrib[o]=[String(t[0]||""),String(t[1]||"")],o},AttributePool.prototype.getAttrib=function(t){var r=this.numToAttrib[t];return r?[r[0],r[1]]:r},AttributePool.prototype.getAttribKey=function(t){var r=this.numToAttrib[t];return r?r[0]:""},AttributePool.prototype.getAttribValue=function(t){var r=this.numToAttrib[t];return r?r[1]:""},AttributePool.prototype.eachAttrib=function(t){for(var r in this.numToAttrib){var i=this.numToAttrib[r];t(i[0],i[1])}},AttributePool.prototype.toJsonable=function(){return{numToAttrib:this.numToAttrib,nextNum:this.nextNum}},AttributePool.prototype.fromJsonable=function(t){this.numToAttrib=t.numToAttrib,this.nextNum=t.nextNum,this.attribToNum={};for(var r in this.numToAttrib)this.attribToNum[String(this.numToAttrib[r])]=Number(r);return this},module.exports=AttributePool;
}
, "ep_etherpad-lite/static/js/Changeset.js": function (require, exports, module) {
var AttributePool=require("./AttributePool");exports.error=function(e){var r=new Error(e);throw r.easysync=!0,r},exports.assert=function(e,r){if(!e){var t=Array.prototype.slice.call(arguments,1).join("");exports.error("Failed assertion: "+t)}},exports.parseNum=function(e){return parseInt(e,36)},exports.numToString=function(e){return e.toString(36).toLowerCase()},exports.toBaseTen=function(e){var r=e.indexOf("$"),t=e.substring(0,r),n=e.substring(r);return t.replace(/[0-9a-z]+/g,function(e){return String(exports.parseNum(e))})+n},exports.oldLen=function(e){return exports.unpack(e).oldLen},exports.newLen=function(e){return exports.unpack(e).newLen},exports.opIterator=function(e,r){function t(){c=i;var r;return p.lastIndex=i,r=p.exec(e),i=p.lastIndex,"?"==r[0]&&exports.error("Hit error opcode in op stream"),r}function n(e){var r=e||l;return u[0]?(r.attribs=u[1],r.lines=exports.parseNum(u[2]||0),r.opcode=u[3],r.chars=exports.parseNum(u[4]),u=t()):exports.clearOp(r),r}function o(){return!!u[0]}function s(){return c}var p=/((?:\*[0-9a-z]+)*)(?:\|([0-9a-z]+))?([-+=])([0-9a-z]+)|\?|/g,a=r||0,i=a,c=i,u=t(),l=exports.newOp();return{next:n,hasNext:o,lastIndex:s}},exports.clearOp=function(e){e.opcode="",e.chars=0,e.lines=0,e.attribs=""},exports.newOp=function(e){return{opcode:e||"",chars:0,lines:0,attribs:""}},exports.cloneOp=function(e){return{opcode:e.opcode,chars:e.chars,lines:e.lines,attribs:e.attribs}},exports.copyOp=function(e,r){r.opcode=e.opcode,r.chars=e.chars,r.lines=e.lines,r.attribs=e.attribs},exports.opString=function(e){if(!e.opcode)return"null";var r=exports.opAssembler();return r.append(e),r.toString()},exports.stringOp=function(e){return exports.opIterator(e).next()},exports.checkRep=function(e){for(var r=exports.unpack(e),t=r.oldLen,n=r.newLen,o=r.ops,s=r.charBank,p=exports.smartOpAssembler(),a=0,i=0,c=0,u=exports.opIterator(o);u.hasNext();){var l=u.next();switch(l.opcode){case"=":a+=l.chars,i+=l.chars;break;case"-":a+=l.chars,exports.assert(t>=a,a," > ",t," in ",e);break;case"+":i+=l.chars,c+=l.chars,exports.assert(n>=i,i," > ",n," in ",e)}p.append(l)}for(i+=t-a,s=s.substring(0,c);s.length<c;)s+="?";p.endDocument();var x=exports.pack(t,i,p.toString(),s);return exports.assert(x==e,"Invalid changeset (checkRep failed)"),e},exports.smartOpAssembler=function(){function e(){l.append(u.toString()),u.clear()}function r(){l.append(i.toString()),i.clear(),l.append(c.toString()),c.clear()}function t(t){t.opcode&&t.chars&&("-"==t.opcode?("="==x&&e(),i.append(t),h-=t.chars):"+"==t.opcode?("="==x&&e(),c.append(t),h+=t.chars):"="==t.opcode&&("="!=x&&r(),u.append(t)),x=t.opcode)}function n(e,r,n,o){var s=exports.newOp(e);s.attribs=exports.makeAttribsString(e,n,o);var p=r.lastIndexOf("\n");0>p?(s.chars=r.length,s.lines=0,t(s)):(s.chars=p+1,s.lines=r.match(/\n/g).length,t(s),s.chars=r.length-(p+1),s.lines=0,t(s))}function o(){return r(),e(),l.toString()}function s(){i.clear(),c.clear(),u.clear(),l.clear(),h=0}function p(){u.endDocument()}function a(){return h}var i=exports.mergingOpAssembler(),c=exports.mergingOpAssembler(),u=exports.mergingOpAssembler(),l=exports.stringAssembler(),x="",h=0;return{append:t,toString:o,clear:s,endDocument:p,appendOpWithText:n,getLengthChange:a}},exports.mergingOpAssembler=function(){function e(e){p.opcode&&(e&&"="==p.opcode&&!p.attribs||(s.append(p),a&&(p.chars=a,p.lines=0,s.append(p),a=0)),p.opcode="")}function r(r){r.chars>0&&(p.opcode==r.opcode&&p.attribs==r.attribs?r.lines>0?(p.chars+=a+r.chars,p.lines+=r.lines,a=0):0==p.lines?p.chars+=r.chars:a+=r.chars:(e(),exports.copyOp(r,p)))}function t(){e(!0)}function n(){return e(),s.toString()}function o(){s.clear(),exports.clearOp(p)}var s=exports.opAssembler(),p=exports.newOp(),a=0;return{append:r,toString:n,clear:o,endDocument:t}},exports.opAssembler=function(){function e(e){n.push(e.attribs),e.lines&&n.push("|",exports.numToString(e.lines)),n.push(e.opcode),n.push(exports.numToString(e.chars))}function r(){return n.join("")}function t(){n.length=0}var n=[];return{append:e,toString:r,clear:t}},exports.stringIterator=function(e){function r(){return i}function t(e){exports.assert(e<=p(),"!(",e," <= ",p(),")")}function n(r){t(r);var n=e.substr(a,r);return i-=n.split("\n").length-1,a+=r,n}function o(r){t(r);var n=e.substr(a,r);return n}function s(e){t(e),a+=e}function p(){return e.length-a}var a=0,i=e.split("\n").length-1;return{take:n,skip:s,remaining:p,peek:o,newlines:r}},exports.stringAssembler=function(){function e(e){t.push(String(e))}function r(){return t.join("")}var t=[];return{append:e,toString:r}},exports.textLinesMutator=function(e){function r(r){e.splice.apply(e,r)}function t(r){return e.get?e.get(r):e[r]}function n(r,t){return e.slice?e.slice(r,t):[]}function o(){return"number"==typeof e.length?e.length:e.length()}function s(){g[0]=m,g[1]=0,v>0&&i(),b=!0}function p(){r(g),g.length=2,g[0]=g[1]=0,b=!1}function a(){return m-g[0]<g.length-2}function i(){return a()||(g.push(t(g[0]+g[1])),g[1]++),2+m-g[0]}function c(e,r){if(e)if(r){b||s();for(var t=0;e>t;t++)v=0,i(),m++}else b&&(e>1?p():i()),m+=e,v=0}function u(e,r,t){e&&(r?c(r,t):(t&&!b&&s(),b&&i(),v+=e))}function l(e){function r(e){var r=g[0]+g[1];return n(r,r+e).join("")}var o="";if(e)if(b||s(),a())if(0==v)o=g[g.length-1],g.length--,o+=r(e-1),g[1]+=e-1;else{o=r(e-1),g[1]+=e-1;var p=g.length-1;o=g[p].substring(v)+o,g[p]=g[p].substring(0,v)+t(g[0]+g[1]),g[1]+=1}else o=r(e),g[1]+=e;return o}function x(e,r){var t="";if(e){if(r)return l(r);b||s();var n=i();t=g[n].substring(v,v+e),g[n]=g[n].substring(0,v)+g[n].substring(v+e)}return t}function h(e,r){if(e)if(b||s(),r){var t=exports.splitTextLines(e);if(a()){var n=g.length-1,o=g[n],p=v;g[n]=o.substring(0,p)+t[0],m++,t.splice(0,1),Array.prototype.push.apply(g,t),m+=t.length,g.push(o.substring(p)),v=0}else Array.prototype.push.apply(g,t),m+=t.length}else{var n=i();g[n]=g[n].substring(0,v)+e+g[n].substring(v),v+=e.length}}function d(){var e=o();return b&&(e+=g.length-2-g[1]),e>m}function f(){b&&p()}var g=[0,0],b=!1,m=0,v=0,k={skip:u,remove:x,insert:h,close:f,hasMore:d,removeLines:l,skipLines:c};return k},exports.applyZip=function(e,r,t,n,o){for(var s=exports.opIterator(e,r),p=exports.opIterator(t,n),a=exports.smartOpAssembler(),i=exports.newOp(),c=exports.newOp(),u=exports.newOp();i.opcode||s.hasNext()||c.opcode||p.hasNext();)!i.opcode&&s.hasNext()&&s.next(i),!c.opcode&&p.hasNext()&&p.next(c),o(i,c,u),u.opcode&&(a.append(u),u.opcode="");return a.endDocument(),a.toString()},exports.unpack=function(e){var r=/Z:([0-9a-z]+)([><])([0-9a-z]+)|/,t=r.exec(e);t&&t[0]||exports.error("Not a exports: "+e);var n=exports.parseNum(t[1]),o=">"==t[2]?1:-1,s=exports.parseNum(t[3]),p=n+o*s,a=t[0].length,i=e.indexOf("$");return 0>i&&(i=e.length),{oldLen:n,newLen:p,ops:e.substring(a,i),charBank:e.substring(i+1)}},exports.pack=function(e,r,t,n){var o=r-e,s=o>=0?">"+exports.numToString(o):"<"+exports.numToString(-o),p=[];return p.push("Z:",exports.numToString(e),s,t,"$",n),p.join("")},exports.applyToText=function(e,r){var t=exports.unpack(e);exports.assert(r.length==t.oldLen,"mismatched apply: ",r.length," / ",t.oldLen);for(var n=exports.opIterator(t.ops),o=exports.stringIterator(t.charBank),s=exports.stringIterator(r),p=exports.stringAssembler();n.hasNext();){var a=n.next();switch(a.opcode){case"+":if(a.lines!=o.peek(a.chars).split("\n").length-1)throw new Error("newline count is wrong in op +; cs:"+e+" and text:"+r);p.append(o.take(a.chars));break;case"-":if(a.lines!=s.peek(a.chars).split("\n").length-1)throw new Error("newline count is wrong in op -; cs:"+e+" and text:"+r);s.skip(a.chars);break;case"=":if(a.lines!=s.peek(a.chars).split("\n").length-1)throw new Error("newline count is wrong in op =; cs:"+e+" and text:"+r);p.append(s.take(a.chars))}}return p.append(s.take(s.remaining())),p.toString()},exports.mutateTextLines=function(e,r){for(var t=exports.unpack(e),n=exports.opIterator(t.ops),o=exports.stringIterator(t.charBank),s=exports.textLinesMutator(r);n.hasNext();){var p=n.next();switch(p.opcode){case"+":s.insert(o.take(p.chars),p.lines);break;case"-":s.remove(p.chars,p.lines);break;case"=":s.skip(p.chars,p.lines,!!p.attribs)}}s.close()},exports.composeAttributes=function(e,r,t,n){if(!e&&t)return r;if(!r)return e;var o=[];e.replace(/\*([0-9a-z]+)/g,function(e,r){return o.push(n.getAttrib(exports.parseNum(r))),""}),r.replace(/\*([0-9a-z]+)/g,function(e,r){for(var s=n.getAttrib(exports.parseNum(r)),p=!1,a=0;a<o.length;a++){var i=o[a];if(i[0]==s[0]){s[1]||t?i[1]=s[1]:o.splice(a,1),p=!0;break}}return p||!s[1]&&!t||o.push(s),""}),o.sort();for(var s=exports.stringAssembler(),p=0;p<o.length;p++)s.append("*"),s.append(exports.numToString(n.putAttrib(o[p])));return s.toString()},exports._slicerZipperFunc=function(e,r,t,n){if("-"==e.opcode)exports.copyOp(e,t),e.opcode="";else if(e.opcode)switch(r.opcode){case"-":r.chars<=e.chars?("="==e.opcode&&(t.opcode="-",t.chars=r.chars,t.lines=r.lines,t.attribs=""),e.chars-=r.chars,e.lines-=r.lines,r.opcode="",e.chars||(e.opcode="")):("="==e.opcode&&(t.opcode="-",t.chars=e.chars,t.lines=e.lines,t.attribs=""),r.chars-=e.chars,r.lines-=e.lines,e.opcode="");break;case"+":exports.copyOp(r,t),r.opcode="";break;case"=":r.chars<=e.chars?(t.opcode=e.opcode,t.chars=r.chars,t.lines=r.lines,t.attribs=exports.composeAttributes(e.attribs,r.attribs,"="==e.opcode,n),r.opcode="",e.chars-=r.chars,e.lines-=r.lines,e.chars||(e.opcode="")):(t.opcode=e.opcode,t.chars=e.chars,t.lines=e.lines,t.attribs=exports.composeAttributes(e.attribs,r.attribs,"="==e.opcode,n),e.opcode="",r.chars-=e.chars,r.lines-=e.lines);break;case"":exports.copyOp(e,t),e.opcode=""}else exports.copyOp(r,t),r.opcode=""},exports.applyToAttribution=function(e,r,t){var n=exports.unpack(e);return exports.applyZip(r,0,n.ops,0,function(e,r,n){return exports._slicerZipperFunc(e,r,n,t)})},exports.mutateAttributionLines=function(e,r,t){function n(){return l&&l.hasNext()||u.hasMore()}function o(e){if((!l||!l.hasNext())&&u.hasMore()){var r=u.removeLines(1);l=exports.opIterator(r)}l&&l.hasNext()?l.next(e):e.opcode=""}function s(e){x||(x=exports.mergingOpAssembler()),x.append(e),e.lines>0&&(exports.assert(1==e.lines,"Can't have op.lines of ",e.lines," in attribution lines"),u.insert(x.toString(),1),x=null)}for(var p=exports.unpack(e),a=exports.opIterator(p.ops),i=p.charBank,c=0,u=exports.textLinesMutator(r),l=null,x=null,h=exports.newOp(),d=exports.newOp(),f=exports.newOp();(h.opcode||a.hasNext()||d.opcode||n())&&(!h.opcode&&a.hasNext()&&a.next(h),h.opcode||d.opcode||x||l&&l.hasNext());)if(!("="==h.opcode&&h.lines>0)||h.attribs||d.opcode||x||l&&l.hasNext())if("+"==h.opcode){if(h.lines>1){var g=i.indexOf("\n",c)+1-c;exports.copyOp(h,f),h.chars-=g,h.lines--,f.lines=1,f.chars=g}else exports.copyOp(h,f),h.opcode="";s(f),c+=f.chars,f.opcode=""}else!d.opcode&&n()&&o(d),exports._slicerZipperFunc(d,h,f,t),f.opcode&&(s(f),f.opcode="");else u.skipLines(h.lines),h.opcode="";exports.assert(!x,"line assembler not finished:"+e),u.close()},exports.joinAttributionLines=function(e){for(var r=exports.mergingOpAssembler(),t=0;t<e.length;t++)for(var n=e[t],o=exports.opIterator(n);o.hasNext();)r.append(o.next());return r.toString()},exports.splitAttributionLines=function(e,r){function t(e){o.append(e),e.lines>0&&(s.push(o.toString()),o.clear()),p+=e.chars}for(var n=exports.opIterator(e),o=exports.mergingOpAssembler(),s=[],p=0;n.hasNext();){for(var a=n.next(),i=a.chars,c=a.lines;c>1;){var u=r.indexOf("\n",p)+1;exports.assert(u>0,"newlineEnd <= 0 in splitAttributionLines"),a.chars=u-p,a.lines=1,t(a),i-=a.chars,c-=a.lines}1==c&&(a.chars=i,a.lines=1),t(a)}return s},exports.splitTextLines=function(e){return e.match(/[^\n]*(?:\n|[^\n]$)/g)},exports.compose=function(e,r,t){var n=exports.unpack(e),o=exports.unpack(r),s=n.oldLen,p=n.newLen;exports.assert(p==o.oldLen,"mismatched composition of two changesets");var a=o.newLen,i=exports.stringIterator(n.charBank),c=exports.stringIterator(o.charBank),u=exports.stringAssembler(),l=exports.applyZip(n.ops,0,o.ops,0,function(e,r,n){var o=e.opcode,s=r.opcode;"+"==o&&"-"==s&&i.skip(Math.min(e.chars,r.chars)),exports._slicerZipperFunc(e,r,n,t),"+"==n.opcode&&("+"==s?u.append(c.take(n.chars)):u.append(i.take(n.chars)))});return exports.pack(s,a,l,u.toString())},exports.attributeTester=function(e,r){function t(e){return!1}if(!r)return t;var n=r.putAttrib(e,!0);if(0>n)return t;var o=new RegExp("\\*"+exports.numToString(n)+"(?!\\w)");return function(e){return o.test(e)}},exports.identity=function(e){return exports.pack(e,e,"","")},exports.makeSplice=function(e,r,t,n,o,s){var p=e.length;r>=p&&(r=p-1),t>e.length-r&&(t=e.length-r);var a=e.substring(r,r+t),i=p+n.length-a.length,c=exports.smartOpAssembler();return c.appendOpWithText("=",e.substring(0,r)),c.appendOpWithText("-",a),c.appendOpWithText("+",n,o,s),c.endDocument(),exports.pack(p,i,c.toString(),n)},exports.toSplices=function(e){for(var r=exports.unpack(e),t=[],n=0,o=exports.opIterator(r.ops),s=exports.stringIterator(r.charBank),p=!1;o.hasNext();){var a=o.next();"="==a.opcode?(n+=a.chars,p=!1):(p||(t.push([n,n,""]),p=!0),"-"==a.opcode?(n+=a.chars,t[t.length-1][1]+=a.chars):"+"==a.opcode&&(t[t.length-1][2]+=s.take(a.chars)))}return t},exports.characterRangeFollow=function(e,r,t,n){for(var o=r,s=t,p=exports.toSplices(e),a=0,i=0;i<p.length;i++){var c=p[i],u=c[0]+a,l=c[1]+a,x=c[2].length,h=x-(l-u);o>=u&&l>=s?o=s=n?u:u+x:o>=l?(o+=h,s+=h):u>=s||(u>=o&&s>=l?s+=h:s>l?(o=u+x,s+=h):s=u),a+=h}return[o,s]},exports.moveOpsToNewPool=function(e,r,t){var n=e.indexOf("$");0>n&&(n=e.length);var o=e.substring(0,n),s=e.substring(n);return o.replace(/\*([0-9a-z]+)/g,function(e,n){var o=exports.parseNum(n),s=r.getAttrib(o);s||exports.error("Can't copy unknown attrib (reference attrib string to non-existant pool entry). Inconsistent attrib state!");var p=t.putAttrib(s);return"*"+exports.numToString(p)})+s},exports.makeAttribution=function(e){var r=exports.smartOpAssembler();return r.appendOpWithText("+",e),r.toString()},exports.eachAttribNumber=function(e,r){var t=e.indexOf("$");0>t&&(t=e.length);var n=e.substring(0,t);n.replace(/\*([0-9a-z]+)/g,function(e,t){return r(exports.parseNum(t)),""})},exports.filterAttribNumbers=function(e,r){return exports.mapAttribNumbers(e,r)},exports.mapAttribNumbers=function(e,r){var t=e.indexOf("$");0>t&&(t=e.length);var n=e.substring(0,t),o=n.replace(/\*([0-9a-z]+)/g,function(e,t){var n=r(exports.parseNum(t));return n===!0?e:"number"==typeof n?"*"+exports.numToString(n):""});return o+e.substring(t)},exports.makeAText=function(e,r){return{text:e,attribs:r||exports.makeAttribution(e)}},exports.applyToAText=function(e,r,t){return{text:exports.applyToText(e,r.text),attribs:exports.applyToAttribution(e,r.attribs,t)}},exports.cloneAText=function(e){return e?{text:e.text,attribs:e.attribs}:void exports.error("atext is null")},exports.copyAText=function(e,r){r.text=e.text,r.attribs=e.attribs},exports.appendATextToAssembler=function(e,r){for(var t=exports.opIterator(e.attribs),n=exports.newOp();t.hasNext();)if(t.next(n),t.hasNext())r.append(n);else if(n.lines<=1)n.lines=0,n.chars--,n.chars&&r.append(n);else{var o=e.text.lastIndexOf("\n",e.text.length-2)+1,s=e.text.length-o-1;n.lines--,n.chars-=s+1,r.append(n),n.lines=0,n.chars=s,n.chars&&r.append(n)}},exports.prepareForWire=function(e,r){var t=new AttributePool,n=exports.moveOpsToNewPool(e,r,t);return{translated:n,pool:t}},exports.isIdentity=function(e){var r=exports.unpack(e);return""==r.ops&&r.oldLen==r.newLen},exports.opAttributeValue=function(e,r,t){return exports.attribsAttributeValue(e.attribs,r,t)},exports.attribsAttributeValue=function(e,r,t){var n="";return e&&exports.eachAttribNumber(e,function(e){t.getAttribKey(e)==r&&(n=t.getAttribValue(e))}),n},exports.builder=function(e){var r=exports.smartOpAssembler(),t=exports.newOp(),n=exports.stringAssembler(),o={keep:function(e,n,s,p){return t.opcode="=",t.attribs=s&&exports.makeAttribsString("=",s,p)||"",t.chars=e,t.lines=n||0,r.append(t),o},keepText:function(e,t,n){return r.appendOpWithText("=",e,t,n),o},insert:function(e,t,s){return r.appendOpWithText("+",e,t,s),n.append(e),o},remove:function(e,n){return t.opcode="-",t.attribs="",t.chars=e,t.lines=n||0,r.append(t),o},toString:function(){r.endDocument();var t=e+r.getLengthChange();return exports.pack(e,t,r.toString(),n.toString())}};return o},exports.makeAttribsString=function(e,r,t){if(!r)return"";if("string"==typeof r)return r;if(t&&r&&r.length){r.length>1&&(r=r.slice(),r.sort());for(var n=[],o=0;o<r.length;o++){var s=r[o];("="==e||"+"==e&&s[1])&&n.push("*"+exports.numToString(t.putAttrib(s)))}return n.join("")}},exports.subattribution=function(e,r,t){function n(){if(a.chars)for(;a.opcode&&(p.opcode||o.hasNext());)p.opcode||o.next(p),a.opcode&&p.opcode&&a.chars>=p.chars&&p.lines>0&&a.lines<=0&&a.lines++,exports._slicerZipperFunc(p,a,i,null),i.opcode&&(s.append(i),i.opcode="")}var o=exports.opIterator(e,0),s=exports.smartOpAssembler(),p=exports.newOp(),a=exports.newOp(),i=exports.newOp();if(a.opcode="-",a.chars=r,n(),void 0===t)for(p.opcode&&s.append(p);o.hasNext();)o.next(p),s.append(p);else a.opcode="=",a.chars=t-r,n();return s.toString()},exports.inverse=function(e,r,t,n){function o(e){return r.get?r.get(e):r[e]}function s(e){return t.get?t.get(e):t[e]}function p(e,r){if(!h||u!=l){h=exports.opIterator(s(l)),u=l;for(var t=0,n=!1;!n&&h.hasNext();)h.next(d),t+d.chars>=x?(d.chars-=x-t,n=!0):t+=d.chars}for(;e>0;){d.chars||h.hasNext()||(l++,x=0,u=l,d.chars=0,h=exports.opIterator(s(l))),d.chars||h.next(d);var o=Math.min(e,d.chars);r(o,d.attribs,o==d.chars&&d.lines>0),e-=o,d.chars-=o,x+=o}d.chars||h.hasNext()||(l++,x=0)}function a(e,r){r?(l+=r,x=0):h&&u==l?p(e,function(){}):x+=e}function i(e){var r=0,t=exports.stringAssembler(),n=o(l).substring(x);r+=n.length,t.append(n);for(var s=l+1;e>r;){var p=o(s);r+=p.length,t.append(p),s++}return t.toString().substring(0,e)}function c(e){var r={};return function(t){return r[t]||(r[t]=e(t)),r[t]}}for(var u,l=0,x=0,h=null,d=exports.newOp("+"),f=exports.unpack(e),g=exports.opIterator(f.ops),b=exports.builder(f.newLen),m=[],v=[];g.hasNext();){var k=g.next();if("="==k.opcode)if(k.attribs){m.length=0,v.length=0,exports.eachAttribNumber(k.attribs,function(e){m.push(n.getAttribKey(e)),v.push(n.getAttribValue(e))});var A=c(function(e){for(var r=[],t=0;t<m.length;t++){var o=m[t],s=v[t],p=exports.attribsAttributeValue(e,o,n);s!=p&&r.push([o,p])}return exports.makeAttribsString("=",r,n)});p(k.chars,function(e,r,t){b.keep(e,t?1:0,A(r))})}else a(k.chars,k.lines),b.keep(k.chars,k.lines);else if("+"==k.opcode)b.remove(k.chars,k.lines);else if("-"==k.opcode){var O=i(k.chars),w=0;p(k.chars,function(e,r,t){b.insert(O.substr(w,e),r),w+=e})}}return exports.checkRep(b.toString())},exports.follow=function(e,r,t,n){var o=exports.unpack(e),s=exports.unpack(r),p=o.oldLen,a=s.oldLen;exports.assert(p==a,"mismatched follow - cannot transform cs1 on top of cs2");var i=exports.stringIterator(o.charBank),c=exports.stringIterator(s.charBank),u=o.newLen,l=0,x=0,h=exports.attributeTester(["insertorder","first"],n),d=exports.applyZip(o.ops,0,s.ops,0,function(e,r,o){if("+"==e.opcode||"+"==r.opcode){var s;if("+"!=r.opcode)s=1;else if("+"!=e.opcode)s=2;else{var p=i.peek(1),a=c.peek(1),u=h(e.attribs),d=h(r.attribs);s=u&&!d?1:d&&!u?2:"\n"==p&&"\n"!=a?2:"\n"!=p&&"\n"==a?1:t?2:1}1==s?(i.skip(e.chars),o.opcode="=",o.lines=e.lines,o.chars=e.chars,o.attribs="",e.opcode=""):(c.skip(r.chars),exports.copyOp(r,o),r.opcode="")}else"-"==e.opcode?r.opcode?e.chars<=r.chars?(r.chars-=e.chars,r.lines-=e.lines,e.opcode="",r.chars||(r.opcode="")):(e.chars-=r.chars,e.lines-=r.lines,r.opcode=""):e.opcode="":"-"==r.opcode?(exports.copyOp(r,o),e.opcode?r.chars<=e.chars?(e.chars-=r.chars,e.lines-=r.lines,r.opcode="",e.chars||(e.opcode="")):(o.lines=e.lines,o.chars=e.chars,r.lines-=e.lines,r.chars-=e.chars,e.opcode=""):r.opcode=""):e.opcode?r.opcode?(o.opcode="=",o.attribs=exports.followAttributes(e.attribs,r.attribs,n),e.chars<=r.chars?(o.chars=e.chars,o.lines=e.lines,r.chars-=e.chars,r.lines-=e.lines,e.opcode="",r.chars||(r.opcode="")):(o.chars=r.chars,o.lines=r.lines,e.chars-=r.chars,e.lines-=r.lines,r.opcode="")):e.opcode="":(exports.copyOp(r,o),r.opcode="");switch(o.opcode){case"=":l+=o.chars,x+=o.chars;break;case"-":l+=o.chars;break;case"+":x+=o.chars}});return x+=u-l,exports.pack(u,x,d,s.charBank)},exports.followAttributes=function(e,r,t){if(!r||!t)return"";if(!e)return r;var n=[];r.replace(/\*([0-9a-z]+)/g,function(e,r){return n.push(t.getAttrib(exports.parseNum(r))),""}),e.replace(/\*([0-9a-z]+)/g,function(e,r){for(var o=t.getAttrib(exports.parseNum(r)),s=0;s<n.length;s++){var p=n[s];if(o[0]==p[0]){o[1]<=p[1]&&n.splice(s,1);break}}return""});for(var o=exports.stringAssembler(),s=0;s<n.length;s++)o.append("*"),o.append(exports.numToString(t.putAttrib(n[s])));return o.toString()},exports.composeWithDeletions=function(e,r,t){var n=exports.unpack(e),o=exports.unpack(r),s=n.oldLen,p=n.newLen;exports.assert(p==o.oldLen,"mismatched composition of two changesets");var a=o.newLen,i=exports.stringIterator(n.charBank),c=exports.stringIterator(o.charBank),u=exports.stringAssembler(),l=exports.applyZip(n.ops,0,o.ops,0,function(e,r,n){var o=e.opcode,s=r.opcode;"+"==o&&"-"==s&&i.skip(Math.min(e.chars,r.chars)),exports._slicerZipperFuncWithDeletions(e,r,n,t),"+"==n.opcode&&("+"==s?u.append(c.take(n.chars)):u.append(i.take(n.chars)))});return exports.pack(s,a,l,u.toString())},exports._slicerZipperFuncWithDeletions=function(e,r,t,n){if("-"==e.opcode)exports.copyOp(e,t),e.opcode="";else if(e.opcode)switch(r.opcode){case"-":r.chars<=e.chars?("="==e.opcode&&(t.opcode="-",t.chars=r.chars,t.lines=r.lines,t.attribs=r.attribs),e.chars-=r.chars,e.lines-=r.lines,r.opcode="",e.chars||(e.opcode="")):("="==e.opcode&&(t.opcode="-",t.chars=e.chars,t.lines=e.lines,t.attribs=r.attribs),r.chars-=e.chars,r.lines-=e.lines,e.opcode="");break;case"+":exports.copyOp(r,t),r.opcode="";break;case"=":r.chars<=e.chars?(t.opcode=e.opcode,t.chars=r.chars,t.lines=r.lines,t.attribs=exports.composeAttributes(e.attribs,r.attribs,"="==e.opcode,n),r.opcode="",e.chars-=r.chars,e.lines-=r.lines,e.chars||(e.opcode="")):(t.opcode=e.opcode,t.chars=e.chars,t.lines=e.lines,t.attribs=exports.composeAttributes(e.attribs,r.attribs,"="==e.opcode,n),e.opcode="",r.chars-=e.chars,r.lines-=e.lines);break;case"":exports.copyOp(e,t),e.opcode=""}else exports.copyOp(r,t),r.opcode=""};
}
, "ep_etherpad-lite/static/js/ChangesetUtils.js": function (require, exports, module) {
exports.buildRemoveRange=function(e,f,n,o){var s=e.lines.offsetOfIndex(n[0]),t=e.lines.offsetOfIndex(o[0]);o[0]>n[0]?(f.remove(t-s-n[1],o[0]-n[0]),f.remove(o[1])):f.remove(o[1]-n[1])},exports.buildKeepRange=function(e,f,n,o,s,t){var i=e.lines.offsetOfIndex(n[0]),p=e.lines.offsetOfIndex(o[0]);o[0]>n[0]?(f.keep(p-i-n[1],o[0]-n[0],s,t),f.keep(o[1],0,s,t)):f.keep(o[1]-n[1],0,s,t)},exports.buildKeepToStartOfRange=function(e,f,n){var o=e.lines.offsetOfIndex(n[0]);f.keep(o,n[0]),f.keep(n[1])};
}
, "ep_etherpad-lite/static/js/skiplist.js": function (require, exports, module) {
function SkipList(){function n(n){var t=p.levels,r=t-1,e=-1,o=0,s=new Array(t),i=new Array(t),d=new Array(t);for(s[r]=p,i[r]=-1,d[r]=0;r>=0;){for(var u=s[r];u.downPtrs[r]&&e+u.downSkips[r]<n;)e+=u.downSkips[r],o+=u.downSkipWidths[r],u=u.downPtrs[r];s[r]=u,i[r]=e,d[r]=o,r--,r>=0&&(s[r]=u)}return{nodes:s,idxs:i,loc:n,widthSkips:d,toString:function(){return"getPoint("+n+")"}}}function t(n){for(var t=0,r=p,e=p.levels-1;e>=0&&r.downPtrs[e];){for(;r.downPtrs[e]&&t+r.downSkipWidths[e]<=n;)t+=r.downSkipWidths[e],r=r.downPtrs[e];e--}return r===p?p.downPtrs[0]||null:r===w?n==c?w.upPtrs[0]||null:null:r}function r(n){return n&&n.width||0}function e(n,t,e){var o=f("insertKey",!1),s={key:t,levels:0,upPtrs:[],downPtrs:[],downSkips:[],downSkipWidths:[]};o.mark("donealloc");var i=n.nodes,d=n.idxs,u=n.loc,l=n.widthSkips[0]+n.nodes[0].downSkipWidths[0],v=r(e);for(o.mark("loop1");0==s.levels||Math.random()<.01;){var S=s.levels;s.levels++,S==i.length&&(i[S]=p,d[S]=-1,p.levels++,w.levels++,p.downPtrs[S]=w,w.upPtrs[S]=p,p.downSkips[S]=a+1,p.downSkipWidths[S]=c,n.widthSkips[S]=0);var h=s,y=i[S],P=y.downPtrs[S],W=u-d[S],x=y.downSkips[S]+1-W;y.downSkips[S]=W,y.downPtrs[S]=h,h.downSkips[S]=x,h.upPtrs[S]=y,h.downPtrs[S]=P,P.upPtrs[S]=h;var O=l-n.widthSkips[S],m=y.downSkipWidths[S]+v-O;y.downSkipWidths[S]=O,h.downSkipWidths[S]=m}o.mark("loop2"),o.literal(i.length,"PNL");for(var S=s.levels;S<i.length;S++){var y=i[S];y.downSkips[S]++,y.downSkipWidths[S]+=v}o.mark("map"),k["$KEY$"+t]=s,a++,c+=v,o.end()}function o(n){return n.nodes[0].downPtrs[0]}function s(n){for(var t=n.nodes[0].downPtrs[0],e=r(t.entry),o=0;o<n.nodes.length;o++)if(o<t.levels){var s=t.upPtrs[o],i=t.downPtrs[o],d=s.downSkips[o]+t.downSkips[o]-1;s.downPtrs[o]=i,i.upPtrs[o]=s,s.downSkips[o]=d;var u=s.downSkipWidths[o]+t.downSkipWidths[o]-e;s.downSkipWidths[o]=u}else{var s=n.nodes[o],i=s.downPtrs[o];s.downSkips[o]--,s.downSkipWidths[o]-=e}delete k["$KEY$"+t.key],a--,c-=e}function i(n){for(var t=n.downSkipWidths[0],e=r(n.entry),o=e-t,s=n,i=0;i<s.levels;)for(s.downSkipWidths[i]+=o,i++;i>=s.levels&&s.upPtrs[i-1];)s=s.upPtrs[i-1];c+=o}function d(n,t){for(var r=t?0:-1,e=n;e!==p;){var o=e.levels-1;e=e.upPtrs[o],r+=t?e.downSkipWidths[o]:e.downSkips[o]}return r}function u(n){return k["$KEY$"+n]}function l(n){function t(t){return t===p?!1:t===w?!0:n(t.entry)}for(var r=p,e=p.levels-1,o=-1;e>=0;){for(var s=r.downPtrs[e];!t(s);)o+=r.downSkips[e],r=s,s=r.downPtrs[e];e--}return o+1}var f=window.PROFILER;f||(f=function(){return{start:noop,mark:noop,literal:noop,end:noop,cancel:noop}});var p={key:null,levels:1,upPtrs:[null],downPtrs:[null],downSkips:[1],downSkipWidths:[0]},w={key:null,levels:1,upPtrs:[null],downPtrs:[null],downSkips:[null],downSkipWidths:[null]},a=0,c=0,k={};p.downPtrs[0]=w,w.upPtrs[0]=p;var v=this;_.extend(this,{length:function(){return a},atIndex:function(t){return 0>t&&console.warn("atIndex("+t+")"),t>=a&&console.warn("atIndex("+t+">="+a+")"),o(n(t)).entry},splice:function(t,r,o){0>t&&console.warn("splice("+t+", ...)"),t+r>a&&(console.warn("splice("+t+", "+r+", ...), N="+a),console.warn("%s %s %s",typeof t,typeof r,typeof a),console.trace()),o||(o=[]);for(var i=n(t),d=0;r>d;d++)s(i);for(var d=o.length-1;d>=0;d--){var l=o[d];e(i,l.key,l);var f=u(l.key);f.entry=l}},next:function(n){return u(n.key).downPtrs[0].entry||null},prev:function(n){return u(n.key).upPtrs[0].entry||null},push:function(n){v.splice(a,0,[n])},slice:function(n,t){if(void 0===n?n=0:0>n&&(n+=a),void 0===t?t=a:0>t&&(t+=a),0>n&&(n=0),n>a&&(n=a),0>t&&(t=0),t>a&&(t=a),dmesg(String([n,t,a])),n>=t)return[];for(var r=v.atIndex(n),e=[r],o=1;t-n>o;o++)r=v.next(r),e.push(r);return e},atKey:function(n){return u(n).entry},indexOfKey:function(n){return d(u(n))},indexOfEntry:function(n){return v.indexOfKey(n.key)},containsKey:function(n){return!!u(n)},atOffset:function(n){return t(n).entry},keyAtOffset:function(n){return v.atOffset(n).key},offsetOfKey:function(n){return d(u(n),!0)},offsetOfEntry:function(n){return v.offsetOfKey(n.key)},setEntryWidth:function(n,t){n.width=t,i(u(n.key))},totalWidth:function(){return c},offsetOfIndex:function(n){return 0>n?0:n>=a?c:v.offsetOfEntry(v.atIndex(n))},indexOfOffset:function(n){return 0>=n?0:n>=c?a:v.indexOfEntry(v.atOffset(n))},search:function(n){return l(n)},debugGetPoint:n,debugDepth:function(){return p.levels}})}var Ace2Common=require("./ace2_common"),_=require("./underscore"),noop=Ace2Common.noop;module.exports=SkipList;
}
, "ep_etherpad-lite/static/js/cssmanager.js": function (require, exports, module) {
function makeCSSManager(e,n){function t(e){if("parent"===n)win=window.parent.parent;else if("inner"===n)win=window;else{if("outer"!==n)throw"Unknown dynamic style container";win=window.parent}for(var t=win.document.styleSheets,r=0;r<t.length;r++){var i=t[r];if(i.title==e)return i}return null}function r(){return c.cssRules||c.rules}function i(e){c.deleteRule?c.deleteRule(e):c.removeRule(e)}function l(e,n){c.insertRule?c.insertRule(n+" {}",e):c.addRule(n,null,e)}function u(e){for(var n=0;n<f.length;n++)if(f[n]==e)return n;return-1}function o(e){var n=u(e);return 0>n&&(l(0,e),f.splice(0,0,e),n=0),r().item(n).style}function a(e){var n=u(e);n>=0&&(i(n),f.splice(n,1))}n===!0?n="parent":n||(n="inner");var c=t(e),f=[];return{selectorStyle:o,removeSelectorStyle:a,info:function(){return f.length+":"+r().length}}}exports.makeCSSManager=makeCSSManager;
}
, "ep_etherpad-lite/static/js/colorutils.js": function (require, exports, module) {
var colorutils={};colorutils.isCssHex=function(o){return/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(o)},colorutils.css2triple=function(o){function l(o){return Number("0x"+o)/255}var r=colorutils.css2sixhex(o);return[l(r.substr(0,2)),l(r.substr(2,2)),l(r.substr(4,2))]},colorutils.css2sixhex=function(o){var l=/[0-9a-fA-F]+/.exec(o)[0];if(6!=l.length){var r=l.charAt(0),t=l.charAt(1),u=l.charAt(2);l=r+r+t+t+u+u}return l},colorutils.triple2css=function(o){function l(o){var l=colorutils.clamp(Math.round(255*o),0,255);return("0"+l.toString(16)).slice(-2)}return"#"+l(o[0])+l(o[1])+l(o[2])},colorutils.clamp=function(o,l,r){return l>o?l:o>r?r:o},colorutils.min3=function(o,l,r){return l>o?r>o?o:r:r>l?l:r},colorutils.max3=function(o,l,r){return o>l?o>r?o:r:l>r?l:r},colorutils.colorMin=function(o){return colorutils.min3(o[0],o[1],o[2])},colorutils.colorMax=function(o){return colorutils.max3(o[0],o[1],o[2])},colorutils.scale=function(o,l,r){return colorutils.clamp(l+o*(r-l),0,1)},colorutils.unscale=function(o,l,r){return colorutils.clamp((o-l)/(r-l),0,1)},colorutils.scaleColor=function(o,l,r){return[colorutils.scale(o[0],l,r),colorutils.scale(o[1],l,r),colorutils.scale(o[2],l,r)]},colorutils.unscaleColor=function(o,l,r){return[colorutils.unscale(o[0],l,r),colorutils.unscale(o[1],l,r),colorutils.unscale(o[2],l,r)]},colorutils.luminosity=function(o){return.3*o[0]+.59*o[1]+.11*o[2]},colorutils.saturate=function(o){var l=colorutils.colorMin(o),r=colorutils.colorMax(o);return 0>=r-l?[1,1,1]:colorutils.unscaleColor(o,l,r)},colorutils.blend=function(o,l,r){return[colorutils.scale(r,o[0],l[0]),colorutils.scale(r,o[1],l[1]),colorutils.scale(r,o[2],l[2])]},colorutils.invert=function(o){return[1-o[0],1-o[1],1-o[2]]},colorutils.complementary=function(o){var l=colorutils.invert(o);return[l[0]>=o[0]?Math.min(1.3*l[0],1):.3*o[0],l[1]>=o[1]?Math.min(1.59*l[1],1):.59*o[1],l[2]>=o[2]?Math.min(1.11*l[2],1):.11*o[2]]},exports.colorutils=colorutils;
}
, "ep_etherpad-lite/static/js/undomodule.js": function (require, exports, module) {
var Changeset=require("./Changeset"),_=require("./underscore"),undoModule=function(){function e(){p.clearStack(),h=0}function t(e,t){for(var n=0,r=0;n>=0&&n<e.length;)n=e.indexOf(t,n),n>=0&&(r++,n++);return r}function n(e,n){return t(Changeset.unpack(e).ops,n)}function r(e,t){if(!e)return t;if(!t)return e;var r=n(e,"+"),a=n(t,"+"),s=n(e,"-"),o=n(t,"-");if(1==r&&1==a&&0==s&&0==o){var l=Changeset.compose(e,t,c()),u=n(l,"+"),p=n(l,"-");if(1==u&&0==p)return l}else if(0==r&&0==a&&1==s&&1==o){var l=Changeset.compose(e,t,c()),u=n(l,"+"),p=n(l,"-");if(0==u&&1==p)return l}return null}function a(e){function t(){"number"==typeof e.selStart&&(n.selStart=e.selStart,n.selEnd=e.selEnd,n.selFocusAtStart=e.selFocusAtStart)}var n=p.getNthFromTop(0);if(!e.backset||Changeset.isIdentity(e.backset))t();else{var a=!1;if(n.eventType==e.eventType){var s=r(e.backset,n.backset);s&&(n.backset=s,t(),a=!0)}a||p.pushEvent(e),h=0}}function s(e){e&&!Changeset.isIdentity(e)&&p.pushExternalChange(e)}function o(e){return"number"!=typeof e.selStart?null:{selStart:e.selStart,selEnd:e.selEnd,selFocusAtStart:e.selFocusAtStart}}function l(e){if(h<p.numEvents()-1){var t=p.getNthFromTop(h),n=p.getNthFromTop(h+1),r=e(t.backset,o(n));p.pushEvent(r),h+=2}else e()}function u(e){if(h>=2){var t=p.getNthFromTop(0),n=p.getNthFromTop(1);e(t.backset,o(n)),p.popEvent(),h-=2}else e()}function c(){return undoModule.apool}var p=function(){function e(){l.length=0,l.push({elementType:p,eventType:"bottom"}),u=1}function t(e){var t=_.extend({},e);t.elementType=p,l.push(t),u++}function n(e){var t=l.length-1;l[t].elementType==h?l[t].changeset=Changeset.compose(l[t].changeset,e,c()):l.push({elementType:h,changeset:e})}function r(e){for(var t=l.length-1-e,n=l.length-1;n>t||l[n].elementType==h;)if(l[n].elementType==h){var r=l[n],a=l[n-1];if(a.backset){var s=r.changeset,o=a.backset;if(a.backset=Changeset.follow(s,a.backset,!1,c()),r.changeset=Changeset.follow(o,r.changeset,!0,c()),"number"==typeof a.selStart){var u=Changeset.characterRangeFollow(s,a.selStart,a.selEnd);a.selStart=u[0],a.selEnd=u[1],a.selStart==a.selEnd&&(a.selFocusAtStart=!1)}}l[n-1]=r,l[n]=a,n>=2&&l[n-2].elementType==h&&(r.changeset=Changeset.compose(l[n-2].changeset,r.changeset,c()),l.splice(n-2,1),n--)}else n--}function a(e){return r(e),l[l.length-1-e]}function s(){return u}function o(){return r(0),u--,l.pop()}var l=[],u=0,p="undoableEvent",h="externalChange";return e(),{numEvents:s,popEvent:o,pushEvent:t,pushExternalChange:n,clearStack:e,getNthFromTop:a}}(),h=0;return{clearHistory:e,reportEvent:a,reportExternalChange:s,performUndo:l,performRedo:u,enabled:!0,apool:null}}();exports.undoModule=undoModule;
}
, "unorm.js": null
, "ep_etherpad-lite/static/js/contentcollector.js": function (require, exports, module) {
function sanitizeUnicode(t){return UNorm.nfc(t)}function makeContentCollector(t,e,n,i,r){function l(t){return!!L[(v.nodeTagName(t)||"").toLowerCase()]}function o(t){return sanitizeUnicode(t.replace(/(\n | \n)/g," ").replace(/[\n\r ]/g," ").replace(/\xa0/g," ").replace(/\t/g,"        "))}function s(t,e){return v.nodeProp(t,"_magicdom_"+e)}function a(t){k.atColumnZero()||y.startNewLine(t)}function u(t,e){if(0==v.nodeNumChildren(t))return!0;if(1==v.nodeNumChildren(t)&&s(t,"shouldBeEmpty")&&"&nbsp;"==v.optNodeInnerHTML(t)&&!s(t,"unpasted")){if(e){var n=v.nodeChild(t,0);h(n,0,e),h(n,1,e)}return!0}return!1}function c(t,e){var n=k.length()-1,i=k.textOfLine(n).length;return 0!=i||_.isEmpty(e.lineAttributes)||(i+=1),i+=t,[n,i]}function f(t,e,n){v.isNodeText(t)||h(t,e,n)}function h(t,e,n){x&&t==x.node&&x.index==e&&(T=c(0,n)),C&&t==C.node&&C.index==e&&(w=c(0,n))}function d(t,e){var n=t.lineAttributes.list;return"none"!=e&&(t.listNesting=(t.listNesting||0)+1),"none"!==e&&e?t.lineAttributes.list=e:delete t.lineAttributes.list,m(t),n}function g(t,e){t.lineAttributes.list&&t.listNesting--,e&&"none"!=e?t.lineAttributes.list=e:delete t.lineAttributes.list,m(t)}function b(t,e){var n=t.author;return t.authorLevel=(t.authorLevel||0)+1,t.author=e,m(t),n}function p(t,e){t.authorLevel--,t.author=e,m(t)}function m(t){var e=[];for(var i in t.attribs)if(t.attribs[i]){var r="::",l=i.split(r);l.length>1?e.push([l[0],l[1]]):e.push([i,"true"])}if(t.authorLevel>0){var o=["author",t.author];n.putAttrib(o,!0)>=0&&e.push(o)}t.attribString=Changeset.makeAttribsString("+",e,n)}function A(t){var e=[["lmkr","1"],["insertorder","first"]].concat(_.map(t.lineAttributes,function(t,e){return[e,t]}));k.appendText("*",Changeset.makeAttribsString("+",e,n))}e=e||{};var v=i||{isNodeText:function(t){return 3==t.nodeType},nodeTagName:function(t){return t.tagName},nodeValue:function(t){return t.nodeValue},nodeNumChildren:function(t){return null==t.childNodes?0:t.childNodes.length},nodeChild:function(t,e){return null==t.childNodes.item?t.childNodes[e]:t.childNodes.item(e)},nodeProp:function(t,e){return t[e]},nodeAttr:function(t,e){return null!=t.getAttribute?t.getAttribute(e):null!=t.attribs?t.attribs[e]:null},optNodeInnerHTML:function(t){return t.innerHTML}},L={div:1,p:1,pre:1,li:1};_.each(hooks.callAll("ccRegisterBlockElements"),function(t){L[t]=1});var N,x,C,k=function(){var t=[],e=[],n=null,i=Changeset.newOp("+"),r={length:function(){return t.length},atColumnZero:function(){return""===t[t.length-1]},startNew:function(){t.push(""),r.flush(!0),n=Changeset.smartOpAssembler()},textOfLine:function(e){return t[e]},appendText:function(e,r){t[t.length-1]+=e,i.attribs=r,i.chars=e.length,n.append(i)},textLines:function(){return t.slice()},attribLines:function(){return e},flush:function(t){n&&(e.push(n.toString()),n=null)}};return r.startNew(),r}(),y={},T=[-1,-1],w=[-1,-1];y.incrementFlag=function(t,e){t.flags[e]=(t.flags[e]||0)+1},y.decrementFlag=function(t,e){t.flags[e]--},y.incrementAttrib=function(t,e){t.attribs[e]?t.attribs[e]++:t.attribs[e]=1,m(t)},y.decrementAttrib=function(t,e){t.attribs[e]--,m(t)},y.startNewLine=function(t){if(t){var e=0==k.textOfLine(k.length()-1).length;e&&!_.isEmpty(t.lineAttributes)&&A(t)}k.startNew()},y.notifySelection=function(t){t&&(N=t,x=N.startPoint,C=N.endPoint)},y.doAttrib=function(t,e){t.localAttribs=t.localAttribs||[],t.localAttribs.push(e),y.incrementAttrib(t,e)},y.collectContent=function(n,i){i||(i={flags:{},localAttribs:null,attribs:{},attribString:"",lineAttributes:{}});var s=i.localAttribs;i.localAttribs=null;var h=l(n),m=u(n,i);h&&a(i);var L=k.length()-1;if(f(n,0,i),v.isNodeText(n)){var N=v.nodeValue(n),S=v.nodeAttr(n.parentNode,"name"),E=hooks.callAll("collectContentLineText",{cc:this,state:i,tname:S,node:n,text:N,styl:null,cls:null}),N="object"==typeof E&&0==E.length?v.nodeValue(n):E[0],M="",O=0;for(0==N.length&&(x&&n==x.node&&(T=c(0,i)),C&&n==C.node&&(w=c(0,i)));N.length>0;){var P=0;if(i.flags.preMode){var U=N.split("\n",1)[0];P=U.length+1,M=N.substring(P),N=U}x&&n==x.node&&x.index-O<=N.length&&(T=c(x.index-O,i)),C&&n==C.node&&C.index-O<=N.length&&(w=c(C.index-O,i));var V=N;!i.flags.preMode&&/^[\r\n]*$/.exec(N)&&(V="");var z=0==k.textOfLine(k.length()-1).length;z&&(V=V.replace(/^\n*/,"")),z&&!_.isEmpty(i.lineAttributes)&&A(i),k.appendText(o(V),i.attribString),O+=P,N=M,N.length>0&&y.startNewLine(i)}}else{var S=(v.nodeTagName(n)||"").toLowerCase();if("img"==S){hooks.callAll("collectContentImage",{cc:y,state:i,tname:S,styl:B,cls:H,node:n})}else delete i.lineAttributes.img;if("br"==S){this.breakLine=!0;var I=v.nodeAttr(n,"value"),q=hooks.callAll("collectContentLineBreak",{cc:this,state:i,tname:S,tvalue:I,styl:null,cls:null}),F="object"==typeof q&&0==q.length?!0:q[0];F&&y.startNewLine(i)}else if("script"==S||"style"==S);else if(!m){var B=v.nodeAttr(n,"style"),H=v.nodeAttr(n,"class"),W="pre"==S;!W&&e.safari&&(W=B&&/\bwhite-space:\s*pre\b/i.exec(B)),W&&y.incrementFlag(i,"preMode");var j=null,X=null;if(t){if(hooks.callAll("collectContentPre",{cc:y,state:i,tname:S,styl:B,cls:H}),("b"==S||B&&/\bfont-weight:\s*bold\b/i.exec(B)||"strong"==S)&&y.doAttrib(i,"bold"),("i"==S||B&&/\bfont-style:\s*italic\b/i.exec(B)||"em"==S)&&y.doAttrib(i,"italic"),("u"==S||B&&/\btext-decoration:\s*underline\b/i.exec(B)||"ins"==S)&&y.doAttrib(i,"underline"),("s"==S||B&&/\btext-decoration:\s*line-through\b/i.exec(B)||"del"==S)&&y.doAttrib(i,"strikethrough"),"ul"==S||"ol"==S){if(n.attribs)var Z=n.attribs["class"];else var Z=null;var R=H&&/(?:^| )list-([a-z]+[0-9]+)\b/.exec(H);if(!R&&!Z)for(var $ in n.children)if(n.children[$]&&"ul"==n.children[$].name&&(Z=n.children[$].attribs["class"]))break;R&&R[1]?Z=R[1]:(Z="ul"==S?Z&&Z.match("indent")||n.attribs&&n.attribs["class"]&&n.attribs["class"].match("indent")?"indent":"bullet":"number",Z+=String(Math.min(_MAX_LIST_LEVEL,(i.listNesting||0)+1))),j=d(i,Z)||"none"}else("div"==S||"p"==S)&&H&&H.match(/(?:^| )ace-line\b/)&&(e.chrome||(j=d(i,Z)||"none"));if(r&&H){var D=H.match(/\S+/g);if(D&&D.length>0)for(var $=0;$<D.length;$++){var G=D[$],J=r(G);if(J){X=b(i,J)||"none";break}}}}for(var K=v.nodeNumChildren(n),$=0;K>$;$++){var G=v.nodeChild(n,$);y.collectContent(G,i)}if(t&&hooks.callAll("collectContentPost",{cc:y,state:i,tname:S,styl:B,cls:H}),W&&y.decrementFlag(i,"preMode"),i.localAttribs)for(var $=0;$<i.localAttribs.length;$++)y.decrementAttrib(i,i.localAttribs[$]);j&&g(i,j),X&&p(i,X)}}e.msie||f(n,1,i),h&&(k.length()-1==L?y.startNewLine(i):a(i)),e.msie&&f(n,1,i),i.localAttribs=s},y.notifyNextNode=function(t){(!t||l(t)&&!u(t))&&a(null)};var S=function(){return T},E=function(){return w};return y.getLines=function(){return k.textLines()},y.finish=function(){function t(){function t(t){if(!(t[0]<0)){var e=t[0],n=t[1];if(e>u)e+=h.length-1;else if(e==u){for(var i=0;n>h[i].length;)n-=h[i].length,i++;e+=i}t[0]=e,t[1]=n}}for(var l=2e3,o=10,s=0,a=0,u=n.length-1;u>=0;u--){var c=n[u],f=e[u];if(c.length>l+o){for(var h=[],d=[];c.length>l;){var g=l;h.push(c.substring(0,g)),c=c.substring(g),d.push(Changeset.subattribution(f,0,g)),f=Changeset.subattribution(f,g)}c.length>0&&(h.push(c),d.push(f)),t(i),t(r),s++,a+=h.length,h.unshift(u,1),n.splice.apply(n,h),d.unshift(u,1),e.splice.apply(e,d)}}return{linesWrapped:s,numLinesAfter:a}}k.flush();var e=k.attribLines(),n=y.getLines();n.length--,e.length--;var i=S(),r=E(),l=t();return{selStart:i,selEnd:r,linesWrapped:l.linesWrapped,numLinesAfter:l.numLinesAfter,lines:n,lineAttribs:e}},y}var _MAX_LIST_LEVEL=16,UNorm=require("unorm"),Changeset=require("./Changeset"),hooks=require("./pluginfw/hooks"),_=require("./underscore");exports.sanitizeUnicode=sanitizeUnicode,exports.makeContentCollector=makeContentCollector;
}
, "ep_etherpad-lite/static/js/changesettracker.js": function (require, exports, module) {
function makeChangesetTracker(e,t,n){function a(){u&&null===g&&(g=e.setTimeout(function(){try{u()}catch(e){}finally{g=null}},0))}var r,o=Changeset.makeAText("\n"),s=null,i=Changeset.identity(1),l=!1,h=!1,u=null,g=null;return r={isTracking:function(){return l},setBaseText:function(e){r.setBaseAttributedText(Changeset.makeAText(e),null)},setBaseAttributedText:function(e,a){n.withCallbacks("setBaseText",function(n){if(l=!0,o=Changeset.cloneAText(e),a){var r=(new AttributePool).fromJsonable(a);o.attribs=Changeset.moveOpsToNewPool(o.attribs,r,t)}s=null,i=Changeset.identity(e.text.length),h=!0;try{n.setDocumentAttributedText(e)}finally{h=!1}})},composeUserChangeset:function(e){l&&(h||Changeset.isIdentity(e)||(i=Changeset.compose(i,e,t),a()))},applyChangesToBase:function(e,a,r){l&&n.withCallbacks("applyChangesToBase",function(n){if(r){var a=(new AttributePool).fromJsonable(r);e=Changeset.moveOpsToNewPool(e,a,t)}o=Changeset.applyToAText(e,o,t);var l=e;if(s){var u=s;s=Changeset.follow(e,u,!1,t),l=Changeset.follow(u,e,!0,t)}var g=!0,p=i;i=Changeset.follow(l,p,g,t);var c=Changeset.follow(p,l,!g,t),f=!0;h=!0;try{n.applyChangesetToDocument(c,f)}finally{h=!1}})},prepareUserChangeset:function(){var e;if(s)e=Changeset.compose(s,i,t);else{"forEach"in Array.prototype||(Array.prototype.forEach=function(e,t){for(var n=0,a=this.length;a>n;n++)n in this&&e.call(t,this[n],n,this)});var n=parent.parent.pad.myUserInfo.userId;if(t.numToAttrib){for(var a in t.numToAttrib)if("author"==t.numToAttrib[a][0]&&t.numToAttrib[a][1]==n)var r=Number(a).toString(36);for(var o,l=Changeset.unpack(i),h=Changeset.opIterator(l.ops),u=Changeset.mergingOpAssembler();h.hasNext();){if(o=h.next(),"+"==o.opcode){var g="";o.attribs.split("*").forEach(function(e){if(e){var n=t.getAttrib(parseInt(e,36));n&&(g+="author"==n[0]?"*"+r:"*"+e)}}),o.attribs=g}u.append(o)}u.endDocument(),i=Changeset.pack(l.oldLen,l.newLen,u.toString(),l.charBank),Changeset.checkRep(i)}e=Changeset.isIdentity(i)?null:i}var l=null;e&&(s=e,i=Changeset.identity(Changeset.newLen(e)),l=e);var p=null;if(l){var c=Changeset.prepareForWire(l,t);p=c.pool.toJsonable(),l=c.translated}var f={changeset:l,apool:p};return f},applyPreparedChangesetToBase:function(){if(!s)throw new Error("applySubmittedChangesToBase: no submitted changes to apply");o=Changeset.applyToAText(s,o,t),s=null},setUserChangeNotificationCallback:function(e){u=e},hasUncommittedChanges:function(){return!(!s&&Changeset.isIdentity(i))}}}var AttributePool=require("./AttributePool"),Changeset=require("./Changeset");exports.makeChangesetTracker=makeChangesetTracker;
}
, "ep_etherpad-lite/static/js/linestylefilter.js": function (require, exports, module) {
var Changeset=require("./Changeset"),hooks=require("./pluginfw/hooks"),linestylefilter={},_=require("./underscore"),AttributeManager=require("./AttributeManager");linestylefilter.ATTRIB_CLASSES={bold:"tag:b",italic:"tag:i",underline:"tag:u",strikethrough:"tag:s"};var lineAttributeMarker="lineAttribMarker";exports.lineAttributeMarker=lineAttributeMarker,linestylefilter.getAuthorClassName=function(e){return"author-"+e.replace(/[^a-y0-9]/g,function(e){return"."==e?"-":"z"+e.charCodeAt(0)+"z"})},linestylefilter.getLineStyleFilter=function(e,t,l,r){if(hooks.aCallAll("aceAttribClasses",linestylefilter.ATTRIB_CLASSES,function(e,t){t.length>=1&&(linestylefilter.ATTRIB_CLASSES=t[0])}),0==e)return l;var i=l,n=function(){function l(e){var t="",l=!1;return Changeset.eachAttribNumber(e,function(e){var i=r.getAttribKey(e);if(i){var n=r.getAttribValue(e);n&&(!l&&_.indexOf(AttributeManager.lineAttributes,i)>=0&&(l=!0),t+="author"==i?" "+linestylefilter.getAuthorClassName(n):"list"==i?" list:"+n:"start"==i?" start:"+n:linestylefilter.ATTRIB_CLASSES[i]?" "+linestylefilter.ATTRIB_CLASSES[i]:hooks.callAllStr("aceAttribsToClasses",{linestylefilter:linestylefilter,key:i,value:n}," "," ",""))}}),l&&(t+=" "+lineAttributeMarker),t.substring(1)}function n(){f=F.next(),o=f.opcode&&l(f.attribs)}function u(){if(g>c)for(s=o,a=f.chars,n();f.opcode&&o==s;)a+=f.chars,n()}var s,a,f,o,g=e,c=0,F=Changeset.opIterator(t);return n(),u(),function(e,t){for(var l=hooks.callAll("disableAuthorColorsForThisLine",{linestylefilter:linestylefilter,text:e,"class":t}," "," ",""),r=null==l||0==l.length?!1:l[0];e.length>0;){if(0>=a||r)return i(e,t);var n=e.length;n>a&&(n=a);var f=e.substring(0,n);e=e.substring(n),i(f,(t&&t+" ")+s),c+=n,a-=n,0==a&&u()}}}();return n},linestylefilter.getAtSignSplitterFilter=function(e,t){var l=/@/g;l.lastIndex=0;for(var r,i=null;r=l.exec(e);)i||(i=[]),i.push(r.index);return i?linestylefilter.textAndClassFuncSplitter(t,i):t},linestylefilter.getRegexpFilter=function(e,t){return function(l,r){function i(e){for(var t=0;t<u.length;t++){var l=u[t];if(e>=l[0]&&e<l[0]+l[1].length)return l[1]}return!1}e.lastIndex=0;for(var n,u=null,s=null;n=e.exec(l);){u||(u=[],s=[]);var a=n.index,f=n[0];u.push([a,f]),s.push(a,a+f.length)}if(!u)return r;var o=function(){var e=0;return function(l,n){var u=l.length,s=n,a=i(e);a&&(s+=" "+t+":"+a),r(l,s),e+=u}}();return linestylefilter.textAndClassFuncSplitter(o,s)}},linestylefilter.REGEX_WORDCHAR=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/,linestylefilter.REGEX_URLCHAR=new RegExp("("+/[-:@a-zA-Z0-9_.,~%+\/\\?=&#!;()$]/.source+"|"+linestylefilter.REGEX_WORDCHAR.source+")"),linestylefilter.REGEX_URL=new RegExp(/(?:(?:https?|s?ftp|ftps|file|nfs):\/\/|(about|geo|mailto|tel):|www\.)/.source+linestylefilter.REGEX_URLCHAR.source+"*(?![:.,;])"+linestylefilter.REGEX_URLCHAR.source,"g"),linestylefilter.getURLFilter=linestylefilter.getRegexpFilter(linestylefilter.REGEX_URL,"url"),linestylefilter.textAndClassFuncSplitter=function(e,t){function l(n,u){if(!t||r>=t.length)e(n,u),i+=n.length;else{var s=t,a=s[r]-i,f=n.length;a>=f?(e(n,u),i+=n.length,a==f&&r++):(a>0&&(e(n.substring(0,a),u),i+=a),r++,l(n.substring(a),u))}}for(var r=0,i=0;t&&r<t.length&&0==t[r];)r++;return l},linestylefilter.getFilterStack=function(e,t,l){var r=linestylefilter.getURLFilter(e,t),i=hooks.callAll("aceGetFilterStack",{linestylefilter:linestylefilter,browser:l});return _.map(i,function(t){r=t(e,r)}),void 0!==l&&l.msie&&(r=linestylefilter.getAtSignSplitterFilter(e,r)),r},linestylefilter.populateDomLine=function(e,t,l,r){function i(e,t){r.appendSpan(e,t)}var n=e;"\n"==n.slice(-1)&&(n=n.substring(0,n.length-1));var u=linestylefilter.getFilterStack(n,i);(u=linestylefilter.getLineStyleFilter(n.length,t,u,l))(n,"")},exports.linestylefilter=linestylefilter;
}
, "ep_etherpad-lite/static/js/domline.js": function (require, exports, module) {
var Security=require("./security"),hooks=require("./pluginfw/hooks"),_=require("./underscore"),lineAttributeMarker=require("./linestylefilter").lineAttributeMarker,noop=function(){},domline={};domline.addToLineClass=function(e,n){return n.replace(/\S+/g,function(n){0==n.indexOf("line:")&&(e=(e?e+" ":"")+n.substring(5))}),e},domline.createDomLine=function(e,n,r,i){function t(e){return domline.processSpaces(e,n)}function l(){var n=f(s.join(""));n||(a&&r?r.msie||(n+="<br/>"):n+="&nbsp;"),e&&(n=(c||"")+n+(u||"")),s=c=u="",n!==p&&(p=n,o.node.innerHTML=p),null!==m&&(o.node.className=m),hooks.callAll("acePostWriteDomLineHTML",{node:o.node})}var o={node:null,appendSpan:noop,prepareForAdd:noop,notifyAdded:noop,clearSpans:noop,finishUpdate:noop,lineMarker:0},a=i;a?o.node=a.createElement("div"):o.node={innerHTML:"",className:""};var s=[],c="",u="",p=null,d=n?_.identity:t,f=n?t:_.identity,m="ace-line";return o.appendSpan=function(e,n){var r=!1;if(n.indexOf(lineAttributeMarker)>=0){var i=/(?:^| )list:(\S+)/.exec(n),t=/(?:^| )start:(\S+)/.exec(n);if(_.map(hooks.callAll("aceDomLinePreProcessLineAttributes",{domline:domline,cls:n}),function(e){c+=e.preHtml,u+=e.postHtml,r|=e.processedMarker}),i&&(i=i[1],i&&(i.indexOf("number")<0?(c+='<ul class="list-'+Security.escapeHTMLAttribute(i)+'"><li>',u="</li></ul>"+u):(t?(1==t[1]&&(m=m+" list-start-"+i),c+="<ol start="+t[1]+' class="list-'+Security.escapeHTMLAttribute(i)+'"><li>'):c+='<ol class="list-'+Security.escapeHTMLAttribute(i)+'"><li>',u+="</li></ol>")),r=!0),_.map(hooks.callAll("aceDomLineProcessLineAttributes",{domline:domline,cls:n}),function(e){c+=e.preHtml,u+=e.postHtml,r|=e.processedMarker}),r)return void(o.lineMarker+=e.length)}var l=null,a=null;n.indexOf("url")>=0&&(n=n.replace(/(^| )url:(\S+)/g,function(e,n,r){return l=r,n+"url"})),n.indexOf("tag")>=0&&(n=n.replace(/(^| )tag:(\S+)/g,function(e,n,r){return a||(a=[]),a.push(r.toLowerCase()),n+r}));var p="",f="";_.map(hooks.callAll("aceCreateDomLine",{domline:domline,cls:n}),function(e){n=e.cls,p+=e.extraOpenTags,f=e.extraCloseTags+f}),!e&&n?m=domline.addToLineClass(m,n):e&&(l&&(urn_schemes=new RegExp("^(about|geo|mailto|tel):"),~l.indexOf("://")||urn_schemes.test(l)||(l="http://"+l),p=p+'<a href="'+Security.escapeHTMLAttribute(l)+'">',f="</a>"+f),a&&(a.sort(),p=p+"<"+a.join("><")+">",a.reverse(),f="</"+a.join("></")+">"+f),s.push('<span class="',Security.escapeHTMLAttribute(n||""),'">',p,d(Security.escapeHTML(e)),f,"</span>"))},o.clearSpans=function(){s=[],m="ace-line",o.lineMarker=0},o.prepareForAdd=l,o.finishUpdate=l,o.getInnerHTML=function(){return p||""},o},domline.processSpaces=function(e,n){if(e.indexOf("<")<0&&!n)return e.replace(/ /g,"&nbsp;");var r=[];if(e.replace(/<[^>]*>?| |[^ <]+/g,function(e){r.push(e)}),n){for(var i=!0,t=!1,l=r.length-1;l>=0;l--){var o=r[l];" "==o?((i||t)&&(r[l]="&nbsp;"),i=!1,t=!0):"<"!=o.charAt(0)&&(i=!1,t=!1)}for(var l=0;l<r.length;l++){var o=r[l];if(" "==o){r[l]="&nbsp;";break}if("<"!=o.charAt(0))break}}else for(var l=0;l<r.length;l++){var o=r[l];" "==o&&(r[l]="&nbsp;")}return r.join("")},exports.domline=domline;
}
, "ep_etherpad-lite/static/js/AttributeManager.js": function (require, exports, module) {
var Changeset=require("./Changeset"),ChangesetUtils=require("./ChangesetUtils"),_=require("./underscore"),lineMarkerAttribute="lmkr",DEFAULT_LINE_ATTRIBUTES=["author","lmkr","insertorder","start"],lineAttributes=[lineMarkerAttribute,"list"],AttributeManager=function(t,e){this.rep=t,this.applyChangesetCallback=e,this.author=""};AttributeManager.DEFAULT_LINE_ATTRIBUTES=DEFAULT_LINE_ATTRIBUTES,AttributeManager.lineAttributes=lineAttributes,AttributeManager.prototype=_(AttributeManager.prototype).extend({applyChangeset:function(t){if(!this.applyChangesetCallback)return t;var e=t.toString();return Changeset.isIdentity(e)||this.applyChangesetCallback(e),t},setAttributesOnRange:function(t,e,r){for(var i,n=t[0];n<=e[0];n++){var s=this._findRowRange(n,t,e),a=s[0],u=s[1],h=this._setAttributesOnRangeByLine(n,a,u,r);i=i?Changeset.compose(i.toString(),h.toString(),this.rep.apool):h}return this.applyChangeset(i)},_findRowRange:function(t,e,r){var i,n,s=this.rep.lines.offsetOfIndex(t),a=this.rep.lines.offsetOfIndex(t+1),u=a-s;return i=t===e[0]?e[1]:this.lineHasMarker(t)?1:0,n=t===r[0]?r[1]:u-1,[i,n]},_setAttributesOnRangeByLine:function(t,e,r,i){var n=Changeset.builder(this.rep.lines.totalWidth());return ChangesetUtils.buildKeepToStartOfRange(this.rep,n,[t,e]),ChangesetUtils.buildKeepRange(this.rep,n,[t,e],[t,r],i,this.rep.apool),n},lineHasMarker:function(t){var e=this;return void 0!==_.find(lineAttributes,function(r){return""!=e.getAttributeOnLine(t,r)})},getAttributeOnLine:function(t,e){var r=this.rep.alines[t];if(r){var i=Changeset.opIterator(r);if(i.hasNext())return Changeset.opAttributeValue(i.next(),e,this.rep.apool)||""}return""},getAttributesOnLine:function(t){var e=this.rep.alines[t],r=[];if(e){var i,n=Changeset.opIterator(e);if(n.hasNext())return i=n.next(),i.attribs?(Changeset.eachAttribNumber(i.attribs,function(t){r.push([this.rep.apool.getAttribKey(t),this.rep.apool.getAttribValue(t)])}.bind(this)),r):[]}return[]},getAttributeOnSelection:function(t,e){function r(t){return u.test(t)}function i(t,e){if(t[1]==e[1]&&t[0]==e[0])return!1;if(t[0]!=e[0]){var s=!0;s=s&&i(t,[t[0],n.lines.atIndex(t[0]).text.length]);for(var a=t[0]+1;a<e[0];a++)s=s&&i([a,0],[a,n.lines.atIndex(a).text.length]);return s=s&&i([e[0],0],[e[0],e[1]])}for(var u=t[0],h=t[1],l=e[1],s=!0,o=Changeset.opIterator(n.alines[u]),p=0;o.hasNext();){var g=o.next(),b=p,f=b+g.chars;if(!r(g.attribs)&&!(h>=f||b>=l)){s=!1;break}p=f}return s}var n=this.rep;if(n.selStart&&n.selEnd){var s=n.selStart[0]==n.selEnd[0]&&n.selEnd[1]===n.selStart[1];s&&e&&0!==n.selStart[1]&&n.selStart[1]--;var a=Changeset.makeAttribsString("+",[[t,"true"]],n.apool),u=new RegExp(a.replace(/\*/g,"\\*")+"(\\*|$)");return i(n.selStart,n.selEnd)}},getAttributesOnPosition:function(t,e){var r=this.rep.alines[t];if(!r)return[];for(var i,n=Changeset.opIterator(r),s=0,a=[];n.hasNext();)if(i=n.next(),s+=i.chars,s>e)return Changeset.eachAttribNumber(i.attribs,function(t){a.push([this.rep.apool.getAttribKey(t),this.rep.apool.getAttribValue(t)])}.bind(this)),a;return a},getAttributesOnCaret:function(){return this.getAttributesOnPosition(this.rep.selStart[0],this.rep.selStart[1])},setAttributeOnLine:function(t,e,r){var i=[0,0],n=Changeset.builder(this.rep.lines.totalWidth()),s=this.lineHasMarker(t);return ChangesetUtils.buildKeepRange(this.rep,n,i,i=[t,0]),s?ChangesetUtils.buildKeepRange(this.rep,n,i,i=[t,1],[[e,r]],this.rep.apool):n.insert("*",[["author",this.author],["insertorder","first"],[lineMarkerAttribute,"1"],[e,r]],this.rep.apool),this.applyChangeset(n)},removeAttributeOnLine:function(t,e,r){var i=Changeset.builder(this.rep.lines.totalWidth()),n=this.lineHasMarker(t),s=!1,a=_(this.getAttributesOnLine(t)).map(function(t){return t[0]!==e||r&&t[0]!==r?"author"===t[0]?[e,this.author]:t:(s=!0,[e,""])});if(s){ChangesetUtils.buildKeepToStartOfRange(this.rep,i,[t,0]);var u=_.chain(a).filter(function(t){return!!t[1]}).map(function(t){return t[0]}).difference(DEFAULT_LINE_ATTRIBUTES).size().value();return n&&!u?ChangesetUtils.buildRemoveRange(this.rep,i,[t,0],[t,1]):ChangesetUtils.buildKeepRange(this.rep,i,[t,0],[t,1],a,this.rep.apool),this.applyChangeset(i)}},toggleAttributeOnLine:function(t,e,r){return this.getAttributeOnLine(t,e)?this.removeAttributeOnLine(t,e):this.setAttributeOnLine(t,e,r)},hasAttributeOnSelectionOrCaretPosition:function(t){var e,r=this.rep.selStart[0]!==this.rep.selEnd[0]||this.rep.selEnd[1]!==this.rep.selStart[1];if(r)e=this.getAttributeOnSelection(t);else{var i=this.getAttributesOnCaret();e=_.contains(_.flatten(i),t)}return e}}),module.exports=AttributeManager;
}
, "ep_etherpad-lite/static/js/ace2_inner": null
, "ep_etherpad-lite/static/js/browser": null
, "ep_etherpad-lite/static/js/AttributePool": null
, "ep_etherpad-lite/static/js/Changeset": null
, "ep_etherpad-lite/static/js/ChangesetUtils": null
, "ep_etherpad-lite/static/js/skiplist": null
, "ep_etherpad-lite/static/js/cssmanager": null
, "ep_etherpad-lite/static/js/colorutils": null
, "ep_etherpad-lite/static/js/undomodule": null
, "unorm": null
, "ep_etherpad-lite/static/js/contentcollector": null
, "ep_etherpad-lite/static/js/changesettracker": null
, "ep_etherpad-lite/static/js/linestylefilter": null
, "ep_etherpad-lite/static/js/domline": null
, "ep_etherpad-lite/static/js/AttributeManager": null
, "ep_etherpad-lite/static/js/ace2_inner/index.js": null
, "ep_etherpad-lite/static/js/browser/index.js": null
, "ep_etherpad-lite/static/js/AttributePool/index.js": null
, "ep_etherpad-lite/static/js/Changeset/index.js": null
, "ep_etherpad-lite/static/js/ChangesetUtils/index.js": null
, "ep_etherpad-lite/static/js/skiplist/index.js": null
, "ep_etherpad-lite/static/js/cssmanager/index.js": null
, "ep_etherpad-lite/static/js/colorutils/index.js": null
, "ep_etherpad-lite/static/js/undomodule/index.js": null
, "unorm/index.js": null
, "ep_etherpad-lite/static/js/contentcollector/index.js": null
, "ep_etherpad-lite/static/js/changesettracker/index.js": null
, "ep_etherpad-lite/static/js/linestylefilter/index.js": null
, "ep_etherpad-lite/static/js/domline/index.js": null
, "ep_etherpad-lite/static/js/AttributeManager/index.js": null
});
