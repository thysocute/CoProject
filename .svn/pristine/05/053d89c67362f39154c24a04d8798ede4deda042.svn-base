require.define({
  "/caretPosition.js": function (require, exports, module) {
function getPositionOfElementOrSelection(e){var t=e.getBoundingClientRect(),i={bottom:t.bottom,height:t.height,top:t.top};return i}function caretLineIsFirstBrowserLine(e,t){var i=t.selStart[0],n=t.lines.atIndex(i).lineNode,o=getFirstRootChildNode(n),r=getPositionOfRepLineAtOffset(o,1);return r.top===e}function getFirstRootChildNode(e){return e.firstChild?getFirstRootChildNode(e.firstChild):e}function getPreviousVisibleLine(e,t){return 0>e?0:isLineVisible(e,t)?e:getPreviousVisibleLine(e-1,t)}function getDimensionOfLastBrowserLineOfRepLine(e,t){var i=t.lines.atIndex(e).lineNode,n=getLastRootChildNode(i),o=getPositionOfRepLineAtOffset(n.node,n.length);return o}function getLastRootChildNode(e){return e.lastChild?getLastRootChildNode(e.lastChild):{node:e,length:e.length}}function caretLineIsLastBrowserLineOfRepLine(e,t){var i=t.selStart[0],n=t.lines.atIndex(i).lineNode,o=getLastRootChildNode(n),r=getPositionOfRepLineAtOffset(o.node,o.length);return r.top===e}function getPreviousVisibleLine(e,t){var i=0;return i>=e?i:isLineVisible(e,t)?e:getPreviousVisibleLine(e-1,t)}function getNextVisibleLine(e,t){var i=t.lines.length()-1;return e>=i?i:isLineVisible(e,t)?e:getNextVisibleLine(e+1,t)}function isLineVisible(e,t){return t.lines.atIndex(e).lineNode.offsetHeight>0}function getDimensionOfFirstBrowserLineOfRepLine(e,t){var i=t.lines.atIndex(e).lineNode,n=getFirstRootChildNode(i),o=getPositionOfRepLineAtOffset(n,1);return o}function getSelectionRange(){var e;if(window.getSelection)return e=window.getSelection(),e.rangeCount>0?e.getRangeAt(0):null}exports.getPosition=function(){var e,t,i=($("#innerdocbody")[0],getSelectionRange()),n=i&&"innerdocbody"===$(i.endContainer).closest("body")[0].id;if(n){var o=i.endOffset>0;if(o){var r=createSelectionRange(i);t=getPositionOfElementOrSelection(r),r.detach()}if(!e||0===e.height){var r=createSelectionRange(i),s=$(document.createTextNode("|"));r.insertNode(s[0]),r.selectNode(s[0]),t=getPositionOfElementOrSelection(r),r.detach(),s.remove()}}return t};var createSelectionRange=function(e){return clonedRange=e.cloneRange(),clonedRange.setStart(e.endContainer,e.endOffset),clonedRange.setEnd(e.endContainer,e.endOffset),clonedRange},getPositionOfRepLineAtOffset=function(e,t){if("BR"===e.tagName||"EMPTY"===e.tagName)return getPositionOfElementOrSelection(e);for(;0===e.length&&e.nextSibling;)e=e.nextSibling;var i=new Range;i.setStart(e,t),i.setEnd(e,t);var n=getPositionOfElementOrSelection(i);return i.detach(),n};exports.getPositionTopOfPreviousBrowserLine=function(e,t){var i=e.top-e.height,n=caretLineIsFirstBrowserLine(e.top,t);if(n){var o=t.selStart[0]-1,r=getPreviousVisibleLine(o,t),s=getDimensionOfLastBrowserLineOfRepLine(r,t);i=s.top}return i},exports.getBottomOfNextBrowserLine=function(e,t){var i=e.bottom+e.height,n=caretLineIsLastBrowserLineOfRepLine(e.top,t);if(n){var o=t.selStart[0]+1,r=getNextVisibleLine(o,t),s=getDimensionOfFirstBrowserLineOfRepLine(r,t);i=s.bottom}return i},exports.getPreviousVisibleLine=getPreviousVisibleLine,exports.getNextVisibleLine=getNextVisibleLine;
}
});
